try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f83edd3d-34db-4a08-aa2c-7567af0c8fc7",e._sentryDebugIdIdentifier="sentry-dbid-f83edd3d-34db-4a08-aa2c-7567af0c8fc7")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1084],{11264:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(95155);n(12115);var i=n(40329),a=n(37767);let l=(0,i.Il)("UltraFeedFollowingSettings",e=>({root:{width:"100%",maxWidth:800,fontFamily:e.typography.fontFamily}})),r=e=>{let{settings:t,updateSettings:n,onClose:r}=e,s=(0,i.IS)(l);return(0,o.jsx)("div",{className:s.root,children:(0,o.jsx)(a.YN,{formValues:{incognitoMode:t.resolverSettings.incognitoMode},onBooleanChange:(e,o)=>{n({resolverSettings:{...t.resolverSettings,incognitoMode:o}})},defaultOpen:!0})})}},19713:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(95155);n(12115);var i=n(40329),a=n(82325),l=n(95178),r=n(32835),s=n(16604),d=n(93657),c=n(70704),p=n(20282);let u=(0,i.Il)("FeedSelectorCheckbox",e=>({container:{display:"flex",alignItems:"center",gap:4,marginLeft:8,marginRight:16},checkboxWrapper:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"center","& .SectionFooterCheckbox-root":{flex:"none"}},checkboxLabel:{whiteSpace:"nowrap"}})),m=e=>{let{currentFeedType:t}=e,n=(0,i.IS)(u),m=(0,a.iZ)(),g=(0,s.H)(),[h,x]=(0,l.j)([r.fW,r.Ef]);if(!c.oax.get()||!m)return null;let f="new"===t,b=async()=>{let e=f?"classic":"new";x(r.fW,"new"===e?"true":"false",{path:"/"}),await g({abTestOverrides:{...m.abTestOverrides,[d.oO.name]:"new"===e?"ultraFeed":"control"}})};return(0,o.jsx)("div",{className:n.container,children:(0,o.jsx)("div",{className:n.checkboxWrapper,children:(0,o.jsx)(p.A,{value:f,onClick:b,label:"Use New Feed",labelClassName:n.checkboxLabel})})})}},20282:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(95155);n(12115);var i=n(88262),a=n(49831),l=n(22299),r=n.n(l),s=n(63591);let d=(0,i.N)("SectionFooterCheckbox",e=>{let{classes:t,label:n,onClick:i,value:l,disabled:d,tooltip:c,tooltipPlacement:p="bottom-start",labelClassName:u}=e,m=(0,o.jsxs)("span",{className:r()(t.root,{[t.disabled]:d}),onClick:d?void 0:i,children:[(0,o.jsx)(a.A,{disableRipple:!0,classes:{root:t.checkbox,checked:t.checked},checked:l}),(0,o.jsx)("span",{className:r()(t.label,u),children:n})]});return c?(0,o.jsx)(s.default,{title:c,placement:p,children:m}):m},{styles:e=>({root:{cursor:"pointer",...e.typography.commentStyle,...e.typography.body2,display:"flex",alignItems:"center",[e.breakpoints.down("xs")]:{flex:"1 0 100%",order:0}},checkbox:{color:e.palette.lwTertiary.main,padding:"2px 8px 0 0","& svg":{height:"1.3rem",width:"1.3rem",position:"relative"}},checked:{"&&":{color:e.palette.lwTertiary.main}},label:{...e.typography.commentStyle,color:e.palette.lwTertiary.main},disabled:{cursor:"default",opacity:.5}})})},21084:(e,t,n)=>{n.d(t,{A:()=>ee});var o=n(95155),i=n(12115),a=n(82325),l=n(55643),r=n(41831),s=n(40329),d=n(33060),c=n(70760),p=n(36944),u=n(48782),m=n(66121),g=n(90252),h=n(22299),x=n.n(h),f=n(72561),b=n(63591);let v=(0,s.Il)("HideReadToggleIcon",e=>({container:{display:"flex",alignItems:"center",justifyContent:"center"},containerHidden:{opacity:0,visibility:"hidden",pointerEvents:"none"},iconButton:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:32,borderRadius:"50%",cursor:"pointer",border:"none",background:"transparent",color:e.palette.grey[600],transition:"all 0.2s ease",padding:0,"&:hover":{opacity:.8}},icon:{fontSize:20}})),y=e=>{let{checked:t,onChange:n,visible:i=!0,disabled:a=!1,className:l}=e,r=(0,s.IS)(v),d=t?"Currently hiding items that are fully read":"Showing all items, including fully read";return(0,o.jsx)("div",{className:x()(r.container,!i&&r.containerHidden,l),children:(0,o.jsx)(b.default,{title:d,placement:"bottom",children:(0,o.jsx)("button",{className:r.iconButton,onClick:()=>n(!t),disabled:a||!i,"aria-label":d,children:(0,o.jsx)(f.A,{icon:t?"EyeSlash":"Eye",className:r.icon})})})})};var S=n(27950);let j=(0,s.Il)("UltraFeedHeader",e=>({root:{display:"flex",alignItems:"center",paddingBottom:8,rowGap:8,overflow:"visible",[e.breakpoints.down("sm")]:{flexWrap:"wrap"}},title:{...(0,g.Jh)(e),whiteSpace:"nowrap",flex:"1 1 0",minWidth:0,[e.breakpoints.down("sm")]:{flex:"1 1 100%"}},hideTitle:{display:"none"},tabsAndControls:{flex:"1 1 auto",minWidth:0,display:"contents",[e.breakpoints.down("sm")]:{display:"flex",alignItems:"center",flex:"1 1 100%"}},tabs:{display:"flex",gap:8,flexWrap:"nowrap",minWidth:0,flex:"1 1 auto",justifyContent:"center",[e.breakpoints.down("sm")]:{flex:"1 1 auto",flexWrap:"wrap",justifyContent:"flex-start"}},controlsContainer:{flex:"1 1 0",display:"flex",justifyContent:"flex-end",minWidth:0,[e.breakpoints.down("sm")]:{flex:"0 0 auto",marginLeft:"auto"}},controls:{display:"flex",alignItems:"center",gap:8,flex:"0 0 auto"},leftSpacer:{flex:"1 1 0",minWidth:0}})),w=e=>{var t,n,a;let{title:l="Your Feed",hideTitle:r,activeTab:d,onTabChange:c,settingsButton:u,titleHref:g,feedSettings:h,updateFeedSettings:x}=e,f=(0,s.IS)(j),{captureEvent:b}=(0,p.z1)(),v=(0,i.useCallback)(e=>{x&&h&&(x({resolverSettings:{...h.resolverSettings,subscriptionsFeedSettings:{...h.resolverSettings.subscriptionsFeedSettings,hideRead:e}}}),b("ultraFeedHideReadToggled",{hideRead:e}))},[h,x,b]),w=!!("following"===d&&h&&x),C=null!=(a=null==h||null==(n=h.resolverSettings)||null==(t=n.subscriptionsFeedSettings)?void 0:t.hideRead)&&a;return(0,o.jsxs)("div",{className:f.root,children:[r&&(0,o.jsx)("div",{className:f.leftSpacer}),!r&&(0,o.jsx)("div",{className:f.title,children:g?(0,o.jsx)(m.Link,{to:g,children:l}):l}),(0,o.jsxs)("div",{className:f.tabsAndControls,children:[(0,o.jsxs)("div",{className:f.tabs,children:[(0,o.jsx)(S.A,{label:"For You",isActive:"ultraFeed"===d,onClick:()=>c("ultraFeed"),showTooltip:!1}),(0,o.jsx)(S.A,{label:"Following",isActive:"following"===d,onClick:()=>c("following"),showTooltip:!1})]}),(0,o.jsx)("div",{className:f.controlsContainer,children:(0,o.jsxs)("div",{className:f.controls,children:[(0,o.jsx)(y,{checked:C,onChange:v,visible:w}),u]})})]})]})};var C=n(93664),I=n(52987);let k=(0,s.Il)("InfoButton",e=>({iconContainer:{cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:4,padding:4,transition:"background-color 0.2s","&:hover":{backgroundColor:e.palette.background.hover}},active:{backgroundColor:e.palette.background.hover},icon:{color:e.palette.grey[600],fontSize:18}})),N=e=>{let{className:t,onClick:n,isActive:i=!1,tooltip:a}=e,l=(0,s.IS)(k);return(0,o.jsx)(b.default,{title:a,disabled:!a,children:(0,o.jsx)("div",{className:x()(l.iconContainer,t,{[l.active]:i}),onClick:n,children:(0,o.jsx)(f.A,{icon:"QuestionMark",className:l.icon})})})};var W=n(53181),F=n(79850);let M=(0,s.Il)("UltraFeedInfo",e=>({settingGroup:{backgroundColor:e.palette.background.paper,width:"100%",padding:16,border:"1px solid ".concat(e.palette.grey[300]),borderRadius:4,paddingLeft:32,paddingRight:32,paddingTop:24,paddingBottom:24,[e.breakpoints.down("sm")]:{paddingLeft:16,paddingRight:16,paddingTop:16,paddingBottom:16}},paragraph:{marginBottom:12,color:e.palette.text.primary,fontSize:"1.1rem",lineHeight:1.6}})),T=()=>{let e=(0,s.IS)(M);return(0,o.jsx)(F.A,{contentType:"ultraFeed",children:(0,o.jsxs)("div",{className:e.settingGroup,children:[(0,o.jsxs)("p",{className:e.paragraph,children:["The ",(0,o.jsx)("strong",{children:"For You"})," feed is an attempt to present you with the content you would most like to see from across all of LessWrong. The content is personalized based on your viewing/voting/etc history and by default includes:"]}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Recent posts and comments"}),(0,o.jsx)("li",{children:"Recent content from users you've followed/subscribed to"}),(0,o.jsx)("li",{children:"Recommended from LessWrong's full archive of posts"}),(0,o.jsx)("li",{children:"Feature content such as Annual Review winners"}),(0,o.jsx)("li",{children:"Your bookmarks"}),(0,o.jsx)("li",{children:"Quick takes"})]}),(0,o.jsxs)("p",{className:e.paragraph,children:["You can adjust the proportion of the content from each source in the settings. Note that within the feed, each comment is always a direct reply to the one above it. Read more in the ",(0,o.jsx)(m.Link,{to:"/posts/AJuZj4Zv9iyHHRFwX/lesswrong-feed-new-now-in-beta",children:"announcement post!"})]})]})})};var B=n(11264),A=n(44914),R=n(87118),z=n(45662),L=n(26632);let D=(0,s.Il)("UltraFeedQuickTakeDialog",e=>({dialogContent:{padding:"0 !important",display:"flex",flexDirection:"column",overflow:"hidden"},stickyHeader:{height:64,display:"flex",alignItems:"center",justifyContent:"flex-start",position:"relative",flexShrink:0,backgroundColor:e.palette.ultrafeedModalHeader.background,borderBottom:e.palette.border.faint,borderRadius:"12px 12px 0 0",zIndex:1,padding:"12px 20px",[e.breakpoints.down("sm")]:{padding:"4px 12px",height:56}},headerTitle:{fontFamily:e.palette.fonts.sansSerifStack,fontSize:"1.4rem",fontWeight:600,margin:"0 auto",paddingRight:36},closeButton:{width:36,height:36,color:e.palette.grey[600],backgroundColor:e.palette.grey[200],borderRadius:4,padding:6,cursor:"pointer",fontSize:36,"&:hover":{color:e.palette.grey[700]},"& svg":{display:"block"}},dialogPaper:{width:"100vw",margin:0,borderRadius:0,overflow:"hidden"},formWrapper:{maxHeight:"50%",flex:1,display:"flex",flexDirection:"column","& .EditorFormComponent-commentEditorHeight .ck.ck-content":{minHeight:"50dvh",maxHeight:"50dvh"}}})),E=e=>{let{onClose:t,currentUser:n}=e,i=(0,s.IS)(D);return(0,L.d)(),(0,o.jsx)(A.A,{open:!0,onClose:t,fullWidth:!0,paperClassName:i.dialogPaper,children:(0,o.jsxs)(R.C,{className:i.dialogContent,children:[(0,o.jsxs)("div",{className:i.stickyHeader,children:[(0,o.jsx)(f.A,{icon:"Close",onClick:t,className:i.closeButton}),(0,o.jsx)("div",{className:i.headerTitle,children:"New quick take"})]}),(0,o.jsx)(z.A,{currentUser:n,successCallback:t,className:i.formWrapper,cancelCallback:t,defaultExpanded:!0,defaultFocus:!0,submitButtonAtBottom:!0})]})})};var H=n(70097),U=n(70704),O=n(75758),P=n(25583),_=n(82645);let V=(0,s.Il)("UltraFeedBottomBar",e=>{var t,n,o;return{wrapper:{position:"fixed",right:80,bottom:20,zIndex:e.zIndexes.ultrafeedBottomBar,[e.breakpoints.down("sm")]:{display:"none"},"@media print":{display:"none"},transition:"all 0.2s ease-in-out"},composerButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",width:48,height:48,padding:10,cursor:"pointer",boxShadow:"0 1px 6px 0 ".concat(e.palette.greyAlpha(.06),", 0 2px 32px 0 ").concat(e.palette.greyAlpha(.16)),transition:"all 0.2s ease-in-out","&:hover":{width:52,height:52,padding:14},...e.palette.intercom?{color:e.palette.text.alwaysBlack,backgroundColor:null!=(o=null==(n=e.palette)||null==(t=n.intercom)?void 0:t.buttonBackground)?o:e.palette.grey[100]}:{backgroundColor:e.palette.grey[100]}},composerIcon:{width:24,height:24},upArrow:{transform:"rotate(90deg)"}}}),$=e=>{let{refetchFeed:t,isTopVisible:n,feedRootEl:a}=e,l=(0,s.IS)(V),{closeDialog:r,isDialogOpen:d}=(0,H.sp)(),{captureEvent:c}=(0,p.z1)(),u=null!=n?n:window.scrollY<50,m=(0,i.useMemo)(()=>d||!u?"ArrowLeft":"Autorenew",[d,u]);return(0,o.jsx)("div",{className:l.wrapper,children:(0,o.jsx)(b.default,{title:d?"Back":u?"Refresh feed":"Return to top of feed",placement:"left",children:(0,o.jsx)("div",{className:l.composerButton,onClick:()=>{if(d){c("ultraFeedBottomBarBackClicked"),r();return}if(!u){c("ultraFeedBottomBarScrollTopClicked"),window.scrollTo({top:(0,_.e)(null!=a?a:null),behavior:"smooth"});return}c("ultraFeedBottomBarRefreshClicked"),t&&t()},children:(0,o.jsx)(f.A,{icon:m,className:x()(l.composerIcon,!d&&!u&&l.upArrow)})})})})};var G=n(96973),q=n(92328),Y=n(24105),Z=n(52444),J=n(95178),Q=n(32835);let K=(0,s.Il)("UltraFeed",e=>({root:{},feedComementItem:{marginBottom:16},sectionTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",overflow:"visible"},feedCheckboxAndSettingsContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginLeft:"auto"},settingsButtonContainer:{display:"flex",alignItems:"center",marginLeft:"auto"},headerButtons:{display:"flex",alignItems:"center"},ultraFeedNewContentContainer:{position:"relative",width:"100%"},returnToTopBar:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:12,paddingBottom:24},returnToTopLink:{...e.typography.body2,...e.typography.commentStyle,color:e.palette.lwTertiary.main,cursor:"pointer",textAlign:"center"},tabsBar:{display:"flex",alignItems:"center",gap:0,marginLeft:24,marginRight:24,flex:"1 1 auto",paddingBottom:0},tabButton:{display:"flex",justifyContent:"center",alignItems:"center",fontFamily:e.typography.fontFamily,fontSize:14,lineHeight:"20px",fontWeight:600,padding:"20px 12px",cursor:"pointer",position:"relative",transition:"color 0.2s",flex:1,"&:hover":{backgroundColor:e.palette.background.hover}},tabButtonInactive:{color:e.palette.grey[500]},tabButtonActive:{color:e.palette.text.primary},tabLabel:{position:"relative",display:"inline-flex",flexDirection:"column"},tabUnderline:{position:"absolute",bottom:-16,left:0,right:0,height:2,backgroundColor:e.palette.primary.main,borderRadius:"3px 3px 0 0"},settingsContainer:{marginBottom:16},settingsContainerExternal:{marginTop:16,marginBottom:32},composerButton:{display:"none",[e.breakpoints.down("sm")]:{display:"flex",position:"fixed",bottom:18,right:18,width:42,height:42,borderRadius:8,backgroundColor:e.palette.primary.main,color:e.palette.text.alwaysWhite,alignItems:"center",justifyContent:"center",boxShadow:e.palette.boxShadow.default,cursor:"pointer",zIndex:e.zIndexes.intercomButton,"&:hover":{backgroundColor:e.palette.primary.dark},"&:active":{transform:"scale(0.95)"}}},composerIcon:{fontSize:24},disabledMessage:{textAlign:"center",padding:40,...e.typography.body1,color:e.palette.text.dim},titleLink:{color:"inherit","&:hover":{color:"inherit",opacity:.8}},refetchLoading:{position:"absolute",top:100,left:"50%",transform:"translateX(-50%) scale(2)",zIndex:10}})),X=e=>{let{settings:t,updateSettings:n,resetSettings:r,truncationMaps:m,settingsVisible:g,onCloseSettings:h,infoVisible:x,useExternalContainer:b,activeTab:v}=e,y=(0,s.IS)(K),S=(0,a.iZ)(),[j,w]=(0,i.useState)(!1),[C,I]=(0,i.useState)(!0),[k,N]=(0,i.useState)(!1),{openDialog:F}=(0,H.sp)(),{captureEvent:M}=(0,p.z1)(),[A]=(0,i.useState)(l.zE),R=(0,i.useRef)(null),z=(0,i.useRef)(null),L=(0,i.useRef)(null),D=(0,i.useRef)(null),U=(0,i.useRef)(null),O=(0,i.useRef)(null),[_,V]=(0,i.useState)("ultraFeed"===v),[J,Q]=(0,i.useState)("following"===v),[X,ee]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=L.current,t=D.current;if(!e||!t)return;let n=new IntersectionObserver(e=>{let[t]=e;I(t.isIntersecting)},{root:null,threshold:0}),o=new IntersectionObserver(e=>{let[t]=e;N(t.isIntersecting)},{root:null,threshold:0});return n.observe(e),o.observe(t),()=>{n.disconnect(),o.disconnect()}},[]),(0,i.useEffect)(()=>{"following"!==v||J||Q(!0),"ultraFeed"!==v||_||V(!0)},[v,J,_]),(0,i.useEffect)(()=>{ee(!0);let e=setTimeout(()=>{ee(!1)},300);return()=>clearTimeout(e)},[v]);let{resolverSettings:et}=t;return(0,o.jsxs)(p.Ig,{pageSectionContext:"ultraFeed",ultraFeedContext:{feedSessionId:A},children:[(0,o.jsx)(P.A,{eventProps:{inViewType:"ultraFeed"},children:(0,o.jsxs)("div",{className:y.root,ref:D,children:[(0,o.jsx)(d.E_,{incognitoMode:et.incognitoMode,children:(0,o.jsxs)(c.F,{children:[(0,o.jsx)("div",{ref:L,style:{scrollMarginTop:400}}),g&&(0,o.jsx)("div",{className:b?y.settingsContainerExternal:y.settingsContainer,children:"ultraFeed"===v?(0,o.jsx)(W.A,{settings:t,updateSettings:n,resetSettingsToDefault:()=>{r()},onClose:()=>null==h?void 0:h(),truncationMaps:m,showFeedSelector:!0}):(0,o.jsx)(B.A,{settings:t,updateSettings:n,onClose:()=>null==h?void 0:h()})}),x&&"ultraFeed"===v&&(0,o.jsx)("div",{className:b?y.settingsContainerExternal:y.settingsContainer,children:(0,o.jsx)(T,{})}),(0,o.jsxs)("div",{className:y.ultraFeedNewContentContainer,style:X?{minHeight:1500}:void 0,children:[j&&(0,o.jsx)("div",{className:y.refetchLoading,children:(0,o.jsx)(G.default,{})}),_&&(0,o.jsx)("div",{ref:U,style:"ultraFeed"===v?void 0:{position:"absolute",inset:0,visibility:"hidden",pointerEvents:"none"},children:(0,o.jsx)(Y.A,{settings:t,sessionId:A,refetchRef:R,fetchPolicy:"cache-first",loadMoreDistanceProp:1e3,firstPageSize:15,pageSize:30})}),J&&(0,o.jsx)("div",{ref:O,style:"following"===v?void 0:{position:"absolute",inset:0,visibility:"hidden",pointerEvents:"none"},children:(0,o.jsx)(Z.F,{feedType:"following",children:(0,o.jsx)(q.A,{embedded:!0,refetchRef:z,settings:t,updateSettings:n,showHideReadToggle:!1})})})]})]})}),(0,u.iq)(S)&&(0,o.jsx)("div",{className:y.composerButton,onClick:()=>{M("ultraFeedComposerQuickTakeDialogOpened"),F({name:"UltraFeedQuickTakeDialog",contents:e=>{let{onClose:t}=e;return(0,o.jsx)(E,{onClose:t,currentUser:S})}})},children:(0,o.jsx)(f.A,{icon:"Plus",className:y.composerIcon})})]})}),k&&(0,o.jsx)($,{refetchFeed:()=>{let e="ultraFeed"===v?R.current:z.current;e&&(w(!0),Promise.resolve(e()).finally(()=>{w(!1)}))},isTopVisible:C,feedRootEl:D.current})]})},ee=e=>{let{alwaysShow:t=!1,hideTitle:n=!1,settingsVisible:l,onSettingsToggle:d}=e,c=(0,s.IS)(K);(0,a.iZ)();let[u,m]=(0,J.j)([Q.eq]),[g,h]=(0,i.useState)(!1),[x,f]=(0,i.useState)(!1),[b,v]=(0,i.useState)(()=>"following"===u[Q.eq]?"following":"ultraFeed"),{captureEvent:y}=(0,p.z1)(),{settings:S,updateSettings:j,resetSettings:k,truncationMaps:W}=(0,O.V)();if(!U.oax.get())return(0,o.jsx)(C.A,{children:(0,o.jsx)("div",{className:c.disabledMessage,children:"The New Feed is currently disabled."})});let F=void 0!==d,M=F?l:g;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(C.A,{children:[(0,o.jsx)(w,{hideTitle:n,activeTab:b,onTabChange:e=>{v(e),m(Q.eq,e,{path:"/"}),"following"===e&&x&&f(!1),y("ultraFeedTabChanged",{tab:e})},settingsButton:F?void 0:(0,o.jsxs)("div",{className:c.headerButtons,children:["ultraFeed"===b&&(0,o.jsx)(N,{onClick:e=>{e.stopPropagation(),y("ultraFeedInfoToggled",{open:!x}),f(!x),!x&&g&&h(!1)},isActive:x,tooltip:"What is the For You feed?"}),(0,o.jsx)(I.A,{showIcon:!0,onClick:e=>{e.stopPropagation(),y("ultraFeedSettingsToggled",{open:!M}),F?null==d||d():(h(!g),!g&&x&&f(!1))}})]}),feedSettings:S,updateFeedSettings:j}),(0,o.jsx)(r.A,{ssr:!1,children:(0,o.jsx)(X,{settings:S,updateSettings:j,resetSettings:k,truncationMaps:W,alwaysShow:t,settingsVisible:M,onCloseSettings:F?d:()=>h(!1),infoVisible:x,useExternalContainer:F,activeTab:b})})]})})}},24105:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(95155),i=n(12115),a=n(52444),l=n(60442),r=n(88337),s=n(85343),d=n(55643);let c=e=>{let{settings:t,sessionId:n,refetchRef:c,firstPageSize:p=15,pageSize:u=30,fetchPolicy:m="cache-first",loadMoreDistanceProp:g}=e,[h]=(0,i.useState)(()=>(0,d.zE)());return(0,o.jsx)(a.F,{feedType:"ultraFeed",children:(0,o.jsx)(l.A,{query:r.Ts,variables:{sessionId:null!=n?n:h,settings:JSON.stringify(t.resolverSettings)},firstPageSize:p,pageSize:u,refetchRef:c,loadMoreDistanceProp:g,fetchPolicy:m,renderers:(0,s.P)({settings:t})})})}},27950:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(95155);n(12115);var i=n(22299),a=n.n(i),l=n(63591),r=n(72561),s=n(40329);let d=(0,s.Il)("TabButton",e=>({tab:{display:"flex",justifyContent:"center",alignItems:"center",minWidth:"120px",fontFamily:e.typography.fontFamily,fontSize:14,lineHeight:"23px",fontWeight:"500",padding:"4px 8px",borderRadius:3,cursor:"pointer",border:"none",background:"none",position:"relative",transition:"all 0.2s",[e.breakpoints.down("xs")]:{fontSize:13,padding:"3px 6px",minWidth:"100px"}},inactiveTab:{...e.dark?{backgroundColor:e.palette.tab.inactive.bannerAdBackground,backdropFilter:e.palette.filters.bannerAdBlurMedium,color:e.palette.text.bannerAdOverlay}:{backgroundColor:e.palette.panelBackground.default,color:e.palette.tab.inactive.text},"&:hover":{color:e.palette.tab.inactive.hover.text}},activeTab:{backgroundColor:e.palette.tab.active.background,color:e.palette.text.alwaysWhite,backdropFilter:e.palette.filters.bannerAdBlurMedium,"&:hover":{backgroundColor:e.palette.tab.active.hover.background}},labsIcon:{marginLeft:3,alignSelf:"center",height:14,width:14,[e.breakpoints.down("xs")]:{height:13,width:13}},sparkleIcon:{marginLeft:3,alignSelf:"center",height:18,width:18,[e.breakpoints.down("xs")]:{height:13,width:13}},personIcon:{position:"relative",top:1,marginLeft:2,alignSelf:"center",height:16,width:16},tagDescriptionTooltip:{margin:8}})),c=e=>{let{label:t,isActive:n,onClick:i,description:c,showLabsIcon:p,showSparkleIcon:u,showPersonIcon:m,className:g,showTooltip:h=!0}=e,x=(0,s.IS)(d),f=(0,o.jsxs)("button",{onClick:i,className:a()(x.tab,n?x.activeTab:x.inactiveTab,g),children:[t,p&&(0,o.jsx)(r.A,{icon:"LabBeaker",className:x.labsIcon}),u&&(0,o.jsx)(r.A,{icon:"Sparkle",className:x.sparkleIcon}),m&&(0,o.jsx)(r.A,{icon:"User",className:x.personIcon})]});return h&&c?(0,o.jsx)(l.default,{title:c,popperClassName:x.tagDescriptionTooltip,hideOnTouchScreens:!0,children:f}):f}},37318:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(95155);n(12115);var i=n(88262),a=n(40329);let l=(0,a.Il)("FeedItemWrapper",e=>({wrapper:{"&:not(:empty)":{marginBottom:16,[e.breakpoints.down("sm")]:{marginBottom:0,borderBottom:e.palette.ultraFeed.cardSeparator}}}})),r=(0,i.N)("FeedItemWrapper",e=>{let{children:t}=e,n=(0,a.IS)(l);return(0,o.jsx)("div",{className:n.wrapper,children:t})})},37767:(e,t,n)=>{n.d(t,{RR:()=>y,YN:()=>w,c_:()=>S,jq:()=>b,tY:()=>v,uO:()=>h,z6:()=>j});var o=n(95155),i=n(12115),a=n(22299),l=n.n(a),r=n(40329),s=n(78030),d=n(87007),c=n(49831),p=n(63591),u=n(72561);let m=(0,r.Il)("UltraFeedSettingsComponents",e=>({settingGroup:{backgroundColor:e.palette.background.paper,width:"100%",padding:16,border:"1px solid ".concat(e.palette.grey[300]),borderRadius:4,paddingLeft:32,paddingRight:32,paddingTop:24,paddingBottom:24,[e.breakpoints.down("sm")]:{paddingLeft:16,paddingRight:16,paddingTop:16,paddingBottom:16}},groupTitle:{fontSize:"1.3rem",fontWeight:600,marginBottom:8,fontFamily:"inherit"},groupDescription:{marginBottom:16,color:e.palette.text.dim,fontSize:"1.1rem",fontFamily:"inherit","& ul":{paddingInlineStart:"30px"}},formulaDescription:{fontSize:"0.9rem",fontWeight:600,lineHeight:"2.5","& code":{fontSize:"0.8rem",fontWeight:600,backgroundColor:e.palette.grey[200],padding:"4px 8px",borderRadius:4}},sourceWeightItem:{marginBottom:16},sourceWeightContainer:{display:"flex",alignItems:"center",gap:16},sourceWeightLabel:{fontSize:"1.15rem",width:160,flexShrink:0},sourceWeightDescription:{fontSize:"1.1rem",color:e.palette.text.dim,marginTop:4,"& ul":{paddingInlineStart:"30px"},"& code":{fontSize:"0.8rem",fontWeight:600,backgroundColor:e.palette.grey[200],padding:"4px 4px",borderRadius:4}},sourceWeightSlider:{width:"100%",flexGrow:1},sourceWeightInput:{marginLeft:12,width:70,padding:6,border:"1px solid "+e.palette.grey[400],borderRadius:4,color:e.palette.text.primary,background:e.palette.background.default,textAlign:"right"},threadAggSelect:{minWidth:"100px",marginLeft:"auto"},lineClampLabel:{fontSize:"1.1rem",width:70,fontWeight:600,flexShrink:0},invalidInput:{borderColor:e.palette.error.main},disabledInput:{opacity:.5,pointerEvents:"none",backgroundColor:e.palette.grey[100]},errorMessage:{color:e.palette.error.main,fontSize:"1.1rem",marginTop:4,textAlign:"right"},errorMessageCenteredText:{textAlign:"center",width:"100%"},customWarningMessage:{fontSize:"1.1rem",color:e.palette.warning.main},checkboxContainer:{display:"flex",alignItems:"center",marginBottom:8},checkboxInput:{marginRight:8,padding:4},checkboxLabel:{cursor:"pointer",fontSize:"1.15rem",flexGrow:1},collapsibleHeader:{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:0},collapsibleHeaderExpanded:{marginBottom:16},collapsibleTitle:{fontSize:"1.3rem",fontWeight:600,marginRight:8},collapsibleIcon:{verticalAlign:"middle",transform:"translateY(2px)",fontSize:18,transition:"transform 0.2s ease-in-out",color:e.palette.grey[700],"&:hover":{color:e.palette.grey[900]}},collapsibleIconExpanded:{transform:"translateY(2px) rotate(90deg)"},preLineDescription:{whiteSpace:"pre-line"},truncationSection:{marginBottom:20},truncationSectionTitle:{fontSize:"1.2rem",fontWeight:600,marginBottom:12,fontFamily:"inherit"},truncationItem:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},truncationLabel:{fontSize:"1.1rem",flexShrink:0},truncationOptionSelect:{padding:"4px 8px",fontSize:"1.1rem",fontFamily:"inherit",cursor:"pointer",border:"1px solid ".concat(e.palette.grey[400]),borderRadius:4,backgroundColor:e.palette.background.default,color:e.palette.text.primary,minWidth:120,textAlign:"center"}})),g=e=>{let{title:t,children:n,defaultOpen:a=!1,className:s}=e,d=(0,r.IS)(m),[c,g]=i.useState(a);return(0,o.jsxs)("div",{className:s,children:[(0,o.jsxs)("div",{className:l()(d.collapsibleHeader,{[d.collapsibleHeaderExpanded]:c}),onClick:()=>{g(!c)},children:[(0,o.jsx)("div",{className:l()(d.collapsibleTitle),children:t}),(0,o.jsx)(p.default,{title:c?"Collapse":"Expand",hideOnTouchScreens:!0,children:(0,o.jsx)(u.A,{icon:"ThickChevronRight",className:l()(d.collapsibleIcon,{[d.collapsibleIconExpanded]:c})})})]}),c&&(0,o.jsx)(o.Fragment,{children:n})]})},h=e=>{let{weights:t,errors:n,onChange:i,defaultOpen:a=!0}=e,c=(0,r.IS)(m);return(0,o.jsxs)(g,{title:"Source Weights",defaultOpen:a,className:c.settingGroup,children:[(0,o.jsx)("p",{className:c.groupDescription,children:"Adjust the relative frequency of different content types in your feed. Higher numbers mean more frequent items. Uses weighted sampling."}),s.DG.map(e=>{let{key:a,label:r,description:s}=e,p=t[a],u=n[a],m="number"==typeof p?p:0;return(0,o.jsxs)("div",{className:c.sourceWeightItem,children:[(0,o.jsxs)("div",{className:c.sourceWeightContainer,children:[(0,o.jsx)("label",{className:c.sourceWeightLabel,children:r}),(0,o.jsx)(d.A,{className:c.sourceWeightSlider,value:m,onChange:(e,t)=>i(a,t),min:0,max:100,step:5}),(0,o.jsx)("input",{type:"number",className:l()(c.sourceWeightInput,{[c.invalidInput]:!!u}),value:p,onChange:e=>i(a,e.target.value),min:0,max:100,step:5})]}),(0,o.jsx)("p",{className:c.sourceWeightDescription,children:s}),u&&(0,o.jsx)("p",{className:c.errorMessage,children:u})]},a)})]})},x=e=>{let{field:t,value:n,onChange:i,label:a,maps:l}=e,d=(0,r.IS)(m),c=t.startsWith("post")?e=>((e,t)=>{if("Full"===e)return"".concat(e," (no limit)");let n=t[e];return"number"==typeof n?"".concat(e," (").concat(n," words)"):e})(e,l.postMap):e=>((e,t)=>{if("Full"===e)return"".concat(e," (no limit)");let n=t[e];return"number"==typeof n?"".concat(e," (").concat(n," words)"):e})(e,l.commentMap);return(0,o.jsxs)("div",{className:d.truncationItem,children:[(0,o.jsx)("label",{className:d.truncationLabel,children:a}),(0,o.jsx)("select",{className:d.truncationOptionSelect,value:n,onChange:e=>i(t,e.target.value),children:s.lA.map(e=>(0,o.jsx)("option",{value:e,children:c(e)},e))})]})},f=e=>{let{field:t,value:n,onChange:i,label:a,error:s,disabled:d,min:c=10,max:p,step:u=50,placeholder:g="unset"}=e,h=(0,r.IS)(m);return(0,o.jsxs)("div",{className:h.truncationItem,children:[(0,o.jsx)("label",{className:h.truncationLabel,children:a}),(0,o.jsx)("input",{type:"number",className:l()(h.sourceWeightInput,{[h.invalidInput]:!!s,[h.disabledInput]:d}),value:""===n?"":n,onChange:e=>i(t,e.target.value),min:c,max:p,step:u,placeholder:g,disabled:d}),s&&(0,o.jsx)("p",{className:h.errorMessage,children:s})]})},b=e=>{let{levels:t,onChange:n,originalSettings:i,defaultOpen:a=!0,postBreakpointError:l,commentBreakpointError:s,maps:d}=e,c=(0,r.IS)(m),p=((e,t)=>{let n=t.commentMap,o=t.postMap,i=new Set(Object.values(n)),a=new Set(Object.values(o)),{displaySettings:l}=e;return!(i.has(l.commentCollapsedInitialWords)&&i.has(l.commentExpandedInitialWords)&&i.has(l.commentMaxWords)&&a.has(l.postInitialWords)&&a.has(l.postMaxWords))})(i,d);return(0,o.jsxs)(g,{title:"Content Display Length",defaultOpen:a,className:c.settingGroup,children:[(0,o.jsx)("div",{className:c.groupDescription,children:(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:'If text is longer than max word in-place, "read more" triggers a popup.'}),(0,o.jsx)("li",{children:"Some comments are deemphasized and will be truncated to a lower level."})]})}),p&&(0,o.jsx)("p",{className:c.customWarningMessage,children:"Note: Some settings were customized in the Advanced view. Saving from the Simple view will overwrite them."}),(0,o.jsxs)("div",{className:c.truncationSection,children:[(0,o.jsx)("h4",{className:c.truncationSectionTitle,children:"Posts"}),(0,o.jsx)(x,{field:"postInitialLevel",value:t.postInitialLevel,onChange:n,label:"Initial words to display",maps:d}),(0,o.jsx)(x,{field:"postMaxLevel",value:t.postMaxLevel,onChange:n,label:"Max words in-place",maps:d}),l&&(0,o.jsx)("p",{className:c.errorMessage,children:l})]}),(0,o.jsxs)("div",{className:c.truncationSection,children:[(0,o.jsx)("h4",{className:c.truncationSectionTitle,children:"Comments"}),(0,o.jsx)(x,{field:"commentCollapsedInitialLevel",value:t.commentCollapsedInitialLevel,onChange:n,label:"Initial (deemphasized)",maps:d}),(0,o.jsx)(x,{field:"commentExpandedInitialLevel",value:t.commentExpandedInitialLevel,onChange:n,label:"Initial (emphasized)",maps:d}),(0,o.jsx)(x,{field:"commentMaxLevel",value:t.commentMaxLevel,onChange:n,label:"Max words in-place",maps:d}),s&&(0,o.jsx)("p",{className:c.errorMessage,children:s})]})]})},v=e=>{let{values:t,errors:n,onLineClampChange:i,onWordCountChange:a,defaultOpen:l=!0}=e,s=(0,r.IS)(m);return(0,o.jsxs)(g,{title:"Advanced Truncation",defaultOpen:l,className:s.settingGroup,children:[(0,o.jsx)("p",{className:s.groupDescription,children:'If text is longer than max word in-place, "read more" triggers a popup.'}),(0,o.jsxs)("div",{className:s.truncationSection,children:[(0,o.jsx)("h4",{className:s.truncationSectionTitle,children:"Posts"}),(0,o.jsx)(f,{field:"postInitialWords",value:t.postInitialWords,onChange:a,label:"Initial words",error:n.postInitialWords}),(0,o.jsx)(f,{field:"postMaxWords",value:t.postMaxWords,onChange:a,label:"Max words in-place",error:n.postMaxWords})]}),(0,o.jsxs)("div",{className:s.truncationSection,children:[(0,o.jsx)("h4",{className:s.truncationSectionTitle,children:"Comments"}),(0,o.jsx)("p",{className:s.groupDescription,children:"Some comments are deemphasized and will be truncated to a shorter length."}),(0,o.jsx)(f,{field:"commentCollapsedInitialWords",value:t.commentCollapsedInitialWords,onChange:a,label:"Initial (deemphasized)",error:n.commentCollapsedInitialWords}),(0,o.jsx)(f,{field:"commentExpandedInitialWords",value:t.commentExpandedInitialWords,onChange:a,label:"Initial (emphasized)",error:n.commentExpandedInitialWords}),(0,o.jsx)(f,{field:"commentMaxWords",value:t.commentMaxWords,onChange:a,label:"Max words in-place",error:n.commentMaxWords})]})]})},y=e=>{let{currentLogImpactFactor:t,onExploreBiasChange:n,defaultOpen:i=!0}=e,a=(0,r.IS)(m),s=Math.max(0,Math.min(2,"number"==typeof t?2-t:1.5));return(0,o.jsxs)(g,{title:"Explore-Exploit Bias",defaultOpen:i,className:a.settingGroup,children:[(0,o.jsx)("p",{className:l()(a.groupDescription,a.preLineDescription),children:"Choose how much the feed prioritizes content based on your past engagement versus popular or new content."}),(0,o.jsxs)("div",{className:a.sourceWeightItem,children:[(0,o.jsxs)("div",{className:a.sourceWeightContainer,children:[(0,o.jsx)("label",{className:a.sourceWeightLabel,children:"Explore Bias"}),(0,o.jsx)(d.A,{className:a.sourceWeightSlider,value:s,onChange:(e,t)=>n(t),min:0,max:2,step:.5}),(0,o.jsx)("input",{type:"number",className:l()(a.sourceWeightInput),value:s,onChange:e=>{let t=parseFloat(e.target.value);isNaN(t)||n(Math.max(0,Math.min(2,t)))},min:0,max:2,step:.5})]}),(0,o.jsxs)("div",{className:a.sourceWeightDescription,children:[(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Left: Strongly prefer content related to what you've read, upvoted, commented on, or from authors you follow."}),(0,o.jsx)("li",{children:"Right: Indifferent to your past interactions, recommend what generally seems good."})]}),(0,o.jsxs)("p",{children:["This adjusts ",(0,o.jsx)("code",{children:"Log Impact Factor"})," and ",(0,o.jsx)("code",{children:"Subscribed Author Boost"})," located in Advanced Settings and ",(0,o.jsx)("code",{children:"Subscribed Author"})," proportion in Source Weights."]})]})]})]})},S=e=>{let{formValues:t,errors:n,onFieldChange:i,defaultOpen:a}=e,c=(0,r.IS)(m),p=e=>t=>i(e,t),u=s.a$.resolverSettings.commentScoring,h=[{key:"quickTakeBoost",label:"Quick Take Boost",description:"Multiplier applied to the score of Quick Takes comments.",min:.5,max:3,step:.01,defaultVal:u.quickTakeBoost},{key:"commentSubscribedAuthorMultiplier",label:"Subscribed Boost",description:"Multiplier for comments by authors you subscribe to or follow. Default: ".concat(u.commentSubscribedAuthorMultiplier),min:1,max:5,step:.1,defaultVal:u.commentSubscribedAuthorMultiplier},{key:"commentDecayFactor",label:"Decay Factor",description:"Controls how quickly comments lose score over time. Higher values mean faster decay. Default: ".concat(u.commentDecayFactor),min:1,max:2.5,step:.1,defaultVal:u.commentDecayFactor},{key:"commentDecayBiasHours",label:"Decay Bias (hours)",description:"Hours to add to comment age for decay calculation. Higher values give newer comments a boost. Default: ".concat(u.commentDecayBiasHours),min:0,max:8,step:.5,defaultVal:u.commentDecayBiasHours},{key:"threadScoreFirstN",label:"Thread First N",description:"Number of top comments to consider when calculating thread score. Default: ".concat(u.threadScoreFirstN),min:1,max:20,step:1,defaultVal:u.threadScoreFirstN}],x={key:"threadScoreAggregation",label:"Thread Agg.",description:"How to aggregate comment scores into a thread score. Default: ".concat(u.threadScoreAggregation),options:[{value:"sum",label:"Sum"},{value:"max",label:"Max"},{value:"logSum",label:"Log Sum"},{value:"avg",label:"Average"}],defaultVal:u.threadScoreAggregation};return(0,o.jsxs)(g,{title:"Comment Scoring",defaultOpen:a,className:c.settingGroup,children:[(0,o.jsx)("div",{className:c.groupDescription,children:(0,o.jsxs)("p",{className:c.formulaDescription,children:[(0,o.jsx)("code",{children:"timeDecayedKarma = ((karma + 1) / (ageHours + commentDecayBiasHours)^(commentDecayFactor))"}),(0,o.jsx)("br",{}),(0,o.jsx)("code",{children:"individualCommentScore = timeDecayedKarma * quickTakeBoost * subscribedMultiplier * (0 if seen already)"}),(0,o.jsx)("br",{}),(0,o.jsx)("code",{children:"baseThreadScore = aggregateMethod(firstN(individualCommentScore))"})]})}),h.map(e=>{var i;let a=t[e.key],r=null==n||null==(i=n[e.key])?void 0:i._errors[0],s="number"==typeof a?a:e.defaultVal,u=p(e.key);return(0,o.jsxs)("div",{className:c.sourceWeightItem,children:[(0,o.jsxs)("div",{className:c.sourceWeightContainer,children:[(0,o.jsx)("label",{className:c.sourceWeightLabel,children:e.label}),(0,o.jsx)(d.A,{className:c.sourceWeightSlider,value:s,onChange:(e,t)=>u(t),min:e.min,max:e.max,step:e.step}),(0,o.jsx)("input",{type:"number",className:l()(c.sourceWeightInput,{[c.invalidInput]:!!r}),value:a,onChange:e=>u(e.target.value),min:e.min,max:e.max,step:e.step})]}),(0,o.jsx)("p",{className:c.sourceWeightDescription,children:e.description}),r&&(0,o.jsx)("p",{className:c.errorMessage,children:r})]},e.key)}),(()=>{var e;let i=t[x.key],a=null==n||null==(e=n[x.key])?void 0:e._errors[0],r=p(x.key);return(0,o.jsxs)("div",{className:c.sourceWeightItem,children:[(0,o.jsxs)("div",{className:c.sourceWeightContainer,children:[(0,o.jsx)("label",{className:c.sourceWeightLabel,children:x.label}),(0,o.jsx)("select",{className:l()(c.sourceWeightInput,c.threadAggSelect,{[c.invalidInput]:!!a}),value:i,onChange:e=>r(e.target.value),children:x.options.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,o.jsx)("p",{className:c.sourceWeightDescription,children:x.description}),a&&(0,o.jsx)("p",{className:c.errorMessage,children:a})]},x.key)})()]})},j=e=>{let{formValues:t,errors:n,onFieldChange:i,defaultOpen:a}=e,c=(0,r.IS)(m),p=s.a$.resolverSettings.threadInterestModel,u=[{key:"commentCoeff",label:"Comment Coefficient",description:"How much each comment you have in a thread contributes to further activity in that thread being shown.",min:0,max:10,step:.5,defaultVal:p.commentCoeff},{key:"voteCoeff",label:"Vote Coefficient",description:"How much each vote you have in a thread contributes to further activity in that thread being shown.",min:0,max:5,step:.25,defaultVal:p.voteCoeff},{key:"viewCoeff",label:"View Coefficient",description:"How much viewing (and especially expanding) an item contributes to further activity in a thread being shown.",min:0,max:2,step:.25,defaultVal:p.viewCoeff},{key:"onReadPostFactor",label:"Read Post Factor",description:"Multiplier if the thread is on a post a user has read.",min:.5,max:2,step:.5,defaultVal:p.onReadPostFactor},{key:"logImpactFactor",label:"Log Impact Factor",description:"Scales the effect of the combined log-of-factors on the final multiplier (Multiplier = 1 + LogOfFactors * Impact).",min:0,max:3,step:.5,defaultVal:p.logImpactFactor},{key:"minOverallMultiplier",label:"Min Overall Multiplier",description:"The minimum final multiplier applied to the thread's base score (e.g., 0.5 for max 50% reduction).",min:.1,max:1,step:.05,defaultVal:p.minOverallMultiplier},{key:"maxOverallMultiplier",label:"Max Overall Multiplier",description:"The maximum final multiplier applied to the thread's base score (e.g., 20 for max 20\xd7 boost).",min:1,max:20,step:.5,defaultVal:p.maxOverallMultiplier},{key:"repetitionDecayHours",label:"Repetition Decay Hours",description:"Hours added to time-since-serving for hyperbolic decay calculation. Higher values mean slower penalty decay.",min:.5,max:8,step:.5,defaultVal:p.repetitionDecayHours},{key:"repetitionPenaltyStrength",label:"Repetition Penalty Strength",description:"How much to penalize a thread each time it's recently shown (0 = no penalty, 0.5 = 50% penalty per recent showing).",min:0,max:.5,step:.05,defaultVal:p.repetitionPenaltyStrength}];return(0,o.jsxs)(g,{title:"Comment Thread Scoring",defaultOpen:a,className:c.settingGroup,children:[(0,o.jsxs)("div",{className:c.groupDescription,children:[(0,o.jsxs)("p",{className:c.formulaDescription,children:[(0,o.jsx)("code",{children:"engagementFactor = (1+commentCoeff*numComments) * (1+voteCoeff*voteScore) * (1+viewCoeff*viewScore) * onReadPostFactor"}),(0,o.jsx)("br",{}),(0,o.jsx)("code",{children:"repetitionPenalty = ∏(1 - repetitionPenaltyStrength / (1 + hoursAgo/repetitionDecayHours))"}),(0,o.jsx)("br",{}),(0,o.jsx)("code",{children:"threadMultiplier = (1 + log(engagementFactor) * logImpactFactor) * repetitionPenalty"}),(0,o.jsx)("br",{}),(0,o.jsx)("code",{children:"clampedThreadMultiplier = clamped(threadMultiplier, minOverallMultiplier, maxOverallMultiplier)"}),(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("code",{children:"overallThreadScore = baseThreadScore * clampedThreadMultiplier"})]}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"See Comment Scoring section for calculation of baseThreadScore"}),(0,o.jsx)("li",{children:"voteScore: smallUpvotes = 1 vote unit, bigUpovtes = 5"}),(0,o.jsx)("li",{children:"viewScore: itemOnViewport = 1 view unit, itemExpanded = 3 view units"}),(0,o.jsx)("li",{children:"onReadPostFactor applies if thread is on a post user has read, otherwise 1.0"}),(0,o.jsx)("li",{children:"repetitionPenalty applies exponentially decaying penalty for each recent showing of the thread"})]})]}),u.map(e=>{var a;let r=t[e.key],s=null==n||null==(a=n[e.key])?void 0:a._errors[0],p="number"==typeof r?r:e.defaultVal;return(0,o.jsxs)("div",{className:c.sourceWeightItem,children:[(0,o.jsxs)("div",{className:c.sourceWeightContainer,children:[(0,o.jsx)("label",{className:c.sourceWeightLabel,children:e.label}),(0,o.jsx)(d.A,{className:c.sourceWeightSlider,value:p,onChange:(t,n)=>i(e.key,n),min:e.min,max:e.max,step:e.step}),(0,o.jsx)("input",{type:"number",className:l()(c.sourceWeightInput,{[c.invalidInput]:!!s}),value:r,onChange:t=>i(e.key,t.target.value),min:e.min,max:e.max,step:e.step})]}),(0,o.jsxs)("p",{id:"".concat(e.key,"-label"),className:c.sourceWeightDescription,children:[e.description," Default: ",e.defaultVal]}),s&&(0,o.jsx)("p",{id:"".concat(e.key,"-error"),className:c.errorMessage,children:s})]},e.key)})]})},w=e=>{let{formValues:t,onBooleanChange:n,defaultOpen:i=!0}=e,a=(0,r.IS)(m);return(0,o.jsxs)(g,{title:"Misc",defaultOpen:i,className:a.settingGroup,children:[(0,o.jsxs)("div",{className:a.checkboxContainer,children:[(0,o.jsx)(c.A,{id:"incognitoModeCheckbox",className:a.checkboxInput,checked:t.incognitoMode,onChange:e=>n("incognitoMode",e.target.checked),color:"primary"}),(0,o.jsx)("label",{htmlFor:"incognitoModeCheckbox",className:a.checkboxLabel,children:"Incognito Mode"})]}),(0,o.jsx)("p",{className:a.groupDescription,children:"When enabled, the feed algorithm does not log viewing behavior (votes and comments will still influence it). This does not disable standard LessWrong analytics separate from the feed."})]})}},47950:(e,t,n)=>{n.d(t,{V:()=>l});var o=n(12115),i=n(31972),a=n(97407);function l(e,t,n){let l=(0,i.PN)(),r=t(e),[s,d]=(0,o.useState)(n),c=(0,o.useCallback)(e=>{d(e),e===n?null==l||l.removeItem(r):null==l||l.setItem(r,e)},[l,r,n]),p=(0,a.ZH)(e);return(0,o.useEffect)(()=>{let e=null==l?void 0:l.getItem(r);e&&d(e)},[r,l]),{[e]:s,["set".concat(p)]:c}}},53181:(e,t,n)=>{n.d(t,{A:()=>P});var o=n(95155),i=n(12115),a=n(78030),l=n(40329),r=n(22299),s=n.n(r),d=n(36944),c=n(42877),p=n(47950),u=n(15653);let m=["hacker-news","recombee-lesswrong-custom","bookmarks","subscriptionsPosts","quicktakes","recentComments","subscriptionsComments","bookmarks","spotlights"].reduce((e,t)=>(e[t]=u.z.number().min(0,{message:"Weight must be non-negative"}),e),{}),g=u.z.object(m),h=u.z.object({lineClampNumberOfLines:u.z.number().int().min(0,"Line clamp must be 0 or greater").default(a.a$.displaySettings.lineClampNumberOfLines),postInitialWords:u.z.number().int().min(0,"Initial words must be 0 or greater").default(a.a$.displaySettings.postInitialWords),postMaxWords:u.z.number().int().min(0,"Max words must be 0 or greater").default(a.a$.displaySettings.postMaxWords),commentCollapsedInitialWords:u.z.number().int().min(0,"Collapsed words must be 0 or greater").default(a.a$.displaySettings.commentCollapsedInitialWords),commentExpandedInitialWords:u.z.number().int().min(0,"Expanded words must be 0 or greater").default(a.a$.displaySettings.commentExpandedInitialWords),commentMaxWords:u.z.number().int().min(0,"Max words must be 0 or greater").default(a.a$.displaySettings.commentMaxWords)}).refine(e=>e.postInitialWords<=e.postMaxWords,{message:"Initial words must be less than or equal to max words",path:["postInitialWords"]}).refine(e=>e.commentCollapsedInitialWords<=e.commentExpandedInitialWords,{message:"Collapsed words must be less than or equal to expanded words",path:["commentCollapsedInitialWords"]}).refine(e=>e.commentExpandedInitialWords<=e.commentMaxWords,{message:"Expanded words must be less than or equal to max words",path:["commentExpandedInitialWords"]}),x=u.z.object({commentDecayFactor:u.z.number().positive({message:"Must be a positive number"}),commentDecayBiasHours:u.z.number().min(0,{message:"Must be non-negative"}),quickTakeBoost:u.z.number().min(.5,{message:"Value must be between 0.5 and 3.0"}).max(3,{message:"Value must be between 0.5 and 3.0"}),commentSubscribedAuthorMultiplier:u.z.number().min(1,{message:"Value must be between 1 and 10"}).max(10,{message:"Value must be between 1 and 10"}),threadScoreAggregation:u.z.enum(["sum","max","logSum","avg"]),threadScoreFirstN:u.z.number().int().positive({message:"Must be a positive integer"})}),f=u.z.object({commentCoeff:u.z.number().min(0,{message:"Must be non-negative"}),voteCoeff:u.z.number().min(0,{message:"Must be non-negative"}),viewCoeff:u.z.number().min(0,{message:"Must be non-negative"}),onReadPostFactor:u.z.number().min(0,{message:"Must be non-negative"}),logImpactFactor:u.z.number(),minOverallMultiplier:u.z.number().min(0,{message:"Must be non-negative"}),maxOverallMultiplier:u.z.number().min(0,{message:"Must be non-negative"}),repetitionDecayHours:u.z.number().min(0,{message:"Must be non-negative"}),repetitionPenaltyStrength:u.z.number().min(0,{message:"Must be non-negative"})}).refine(e=>e.minOverallMultiplier<=e.maxOverallMultiplier,{message:"Min overall multiplier must be less than or equal to max overall multiplier",path:["minOverallMultiplier"]}),b=u.z.object({hideRead:u.z.boolean()}),v=u.z.object({incognitoMode:u.z.boolean(),sourceWeights:g.default(a.a$.resolverSettings.sourceWeights),commentScoring:x.default(a.a$.resolverSettings.commentScoring),threadInterestModel:f.default(a.a$.resolverSettings.threadInterestModel),subscriptionsFeedSettings:b.default(a.a$.resolverSettings.subscriptionsFeedSettings)}),y=u.z.object({displaySettings:h.default(a.a$.displaySettings),resolverSettings:v}).partial();var S=n(32966),j=n.n(S),w=n(70361),C=n.n(w),I=n(65180),k=n(97885),N=n(96973),W=n(48405);let F=(0,l.Il)("UltraFeedFeedback",e=>({feedbackContainer:{marginBottom:12}})),M=(0,k.J)("\n  query SingleCommentForFeedback($documentId: String!) {\n    comment(input: { selector: { _id: $documentId } }) {\n      result {\n        ...UltraFeedComment\n      }\n    }\n  }\n"),T=()=>{var e;let t=(0,l.IS)(F),{data:n,loading:i}=(0,I.IT)(M,{variables:{documentId:"9tCBbuxcFKveZGbuR"}}),r=null==n||null==(e=n.comment)?void 0:e.result;if(i)return(0,o.jsx)("div",{className:t.feedbackContainer,children:(0,o.jsx)(N.default,{})});if(!r||!r._id)return(0,o.jsx)("div",{className:t.feedbackContainer,children:"Error loading feedback comment."});let s={_id:r._id,comments:[r],commentMetaInfos:{[r._id]:{displayStatus:"expanded",sources:[],descendentCount:0,directDescendentCount:0,highlight:!1,lastServed:new Date,lastViewed:null,lastInteracted:null,postedAt:r.postedAt?new Date(r.postedAt):new Date,servedEventId:"feedback-comment"}}},d={...a.a$,displaySettings:{...a.a$.displaySettings,commentExpandedInitialWords:50}};return(0,o.jsx)("div",{className:t.feedbackContainer,children:(0,o.jsx)(W.A,{thread:s,index:0,settings:d,startReplyingTo:r._id})})};var B=n(19713),A=n(37767);let R=(0,l.Il)("UltraFeedSettings",e=>({root:{width:"100%",fontFamily:e.palette.fonts.sansSerifStack,marginBottom:16},viewModeToggle:{display:"flex",justifyContent:"space-between",marginBottom:12,alignItems:"center",position:"relative"},viewModeButtonsContainer:{display:"flex",columnGap:8,flex:"1 1 0",justifyContent:"center"},spacer:{flex:"1 1 0"},viewModeButton:{display:"flex",justifyContent:"center",alignItems:"center",fontFamily:e.typography.fontFamily,fontSize:14,lineHeight:"23px",fontWeight:500,padding:"4px 8px",borderRadius:4,width:100,cursor:"pointer",border:"1px solid transparent",backgroundColor:"transparent"},viewModeButtonInactive:{color:e.palette.grey[900],backgroundColor:e.palette.grey[250],fontWeight:500,"&:hover":{backgroundColor:e.palette.grey[300]}},viewModeButtonActive:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary,opacity:1,fontWeight:600},feedbackButtonContainer:{flex:"1 1 0",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:8},feedbackButton:{color:e.palette.grey[600],cursor:"pointer",fontSize:"1.2rem",fontStyle:"italic",padding:"4px 8px",borderRadius:4,fontFamily:e.palette.fonts.sansSerifStack,"&:hover":{color:e.palette.ultraFeed.dim,backgroundColor:e.palette.panelBackground.hoverHighlightGrey},[e.breakpoints.down("sm")]:{fontSize:12,marginRight:4}},feedbackButtonActive:{color:e.palette.ultraFeed.dim,backgroundColor:e.palette.panelBackground.hoverHighlightGrey},buttonRow:{display:"flex",justifyContent:"flex-end",marginTop:12},button:{minWidth:100,padding:"8px 16px",border:"none",borderRadius:4,cursor:"pointer",fontFamily:"inherit",fontSize:14,fontWeight:500,"&:hover":{backgroundColor:e.palette.primary.dark},"&:not(:last-child)":{marginRight:1.5*e.spacing.unit}},saveButton:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,fontWeight:600},resetButton:{color:e.palette.grey[900],backgroundColor:e.palette.grey[250],fontWeight:500,"&:hover":{backgroundColor:e.palette.grey[300]}},buttonDisabled:{backgroundColor:e.palette.grey[300],color:e.palette.grey[600],cursor:"not-allowed","&:hover":{backgroundColor:e.palette.grey[300]}},settingsGroupsContainer:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",[e.breakpoints.down("sm")]:{gap:"4px"}}})),z=e=>{let{exploreExploitBiasProps:t,sourceWeights:n,sourceWeightErrors:i,onSourceWeightChange:a,truncationGridProps:l,miscSettingsProps:r}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(A.RR,{...t}),(0,o.jsx)(A.uO,{weights:n,errors:i,onChange:a}),(0,o.jsx)(A.jq,{...l,defaultOpen:!0}),(0,o.jsx)(A.YN,{...r,defaultOpen:!1})]})},L=e=>{let{sourceWeights:t,sourceWeightErrors:n,onSourceWeightChange:i,advancedTruncationProps:a,commentScoringFormValues:l,commentScoringErrors:r,onCommentScoringFieldChange:s,threadInterestModelFormValues:d,threadInterestModelErrors:c,onThreadInterestFieldChange:p,miscSettingsProps:u}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(A.uO,{weights:t,errors:n,onChange:i}),(0,o.jsx)(A.tY,{...a}),(0,o.jsx)(A.c_,{formValues:l,errors:r,onFieldChange:s,defaultOpen:!1}),(0,o.jsx)(A.z6,{formValues:d,errors:c,onFieldChange:p,defaultOpen:!1}),(0,o.jsx)(A.YN,{...u})]})},D=(e,t)=>{if(""===e)return 0;let n=Number(e);return isNaN(n)?t:n},E=(e,t)=>null!=t?t:e,H=e=>{var t,n,o,i,l,r,s;let{displaySettings:d,resolverSettings:c}=a.a$,{commentScoring:p,threadInterestModel:u}=c,{displaySettings:m,resolverSettings:g}=e;return{sourceWeights:j()(C()(a.oz),g.sourceWeights,E),incognitoMode:null!=(t=g.incognitoMode)?t:c.incognitoMode,displaySetting:{lineClampNumberOfLines:null!=(n=m.lineClampNumberOfLines)?n:d.lineClampNumberOfLines,postInitialWords:null!=(o=m.postInitialWords)?o:d.postInitialWords,postMaxWords:null!=(i=m.postMaxWords)?i:d.postMaxWords,commentCollapsedInitialWords:null!=(l=m.commentCollapsedInitialWords)?l:d.commentCollapsedInitialWords,commentExpandedInitialWords:null!=(r=m.commentExpandedInitialWords)?r:d.commentExpandedInitialWords,commentMaxWords:null!=(s=m.commentMaxWords)?s:d.commentMaxWords},commentScoring:j()(C()(p),g.commentScoring,E),threadInterestModel:j()(C()(u),g.threadInterestModel,E)}},U=(e,t)=>({commentCollapsedInitialLevel:(0,a.SA)(e.displaySettings.commentCollapsedInitialWords,t.commentMap),commentExpandedInitialLevel:(0,a.SA)(e.displaySettings.commentExpandedInitialWords,t.commentMap),commentMaxLevel:(0,a.SA)(e.displaySettings.commentMaxWords,t.commentMap),postInitialLevel:(0,a.SA)(e.displaySettings.postInitialWords,t.postMap),postMaxLevel:(0,a.SA)(e.displaySettings.postMaxWords,t.postMap)}),O=e=>{let{mode:t,currentViewMode:n,onClick:i}=e,a=(0,l.IS)(R);return(0,o.jsx)("div",{onClick:()=>i(t),className:s()(a.viewModeButton,n===t?a.viewModeButtonActive:a.viewModeButtonInactive),children:t.charAt(0).toUpperCase()+t.slice(1)})},P=e=>{var t,n,r,u,m,g,h,x,f,b,v,S,w,I,k,N,W,F,M,A,E,P,_,V,$,G,q,Y,Z,J,Q,K,X,ee,et,en,eo;let{settings:ei,updateSettings:ea,resetSettingsToDefault:el,onClose:er,initialViewMode:es="simple",truncationMaps:ed,showFeedSelector:ec=!1}=e,{captureEvent:ep}=(0,d.z1)(),eu=(0,l.IS)(R),{flash:em}=(0,c.o)(),[eg,eh]=(0,i.useState)(!1),{ultraFeedSettingsViewMode:ex,setUltraFeedSettingsViewMode:ef}=(0,p.V)("ultraFeedSettingsViewMode",e=>e,es),eb=ex&&["simple","advanced"].includes(ex)?ex:es,ev=e=>{ep("ultraFeedSettingsViewModeChanged",{from:eb,to:e}),ef(e)},[ey,eS]=(0,i.useState)(()=>U(ei,ed)),[ej,ew]=(0,i.useState)(()=>H(ei)),[eC,eI]=(0,i.useState)(null),ek=i.useMemo(()=>Object.keys(a.oz).reduce((e,t)=>{var n,o,i;return e[t]=null==eC||null==(i=eC.resolverSettings)||null==(o=i.sourceWeights)||null==(n=o[t])?void 0:n._errors[0],e},{}),[eC]);(0,i.useEffect)(()=>{ew(H(ei)),eS(U(ei,ed))},[ei,ed]);let eN=(0,i.useCallback)((e,t)=>{eI(null),ew(n=>{let o="function"==typeof t?t(n[e]):t;return{...n,[e]:o}})},[]),eW=(0,i.useCallback)((e,t)=>{eI(null),ew(n=>({...n,displaySetting:{...n.displaySetting,[e]:"function"==typeof t?t(n.displaySetting[e]):t}}))},[]),eF=(0,i.useCallback)((e,t)=>{let n="",o=String(t).trim();if(""===o)n="";else{let e=parseInt(o,10);n=!isNaN(e)&&Number.isInteger(Number(o))?e:""}eN("sourceWeights",t=>({...t,[e]:n}))},[eN]),eM=(0,i.useCallback)((e,t)=>{eI(null),eS(n=>({...n,[e]:t}))},[]),eT=(0,i.useCallback)((e,t)=>{eI(null),"incognitoMode"===e&&eN(e,t)},[eN]),eB=(0,i.useCallback)(e=>{let t=String(e).trim();if(""===t)eW("lineClampNumberOfLines","");else{let e=parseInt(t,10);eW("lineClampNumberOfLines",isNaN(e)?"":e)}},[eW]),eA=(0,i.useCallback)((e,t)=>{let n=String(t).trim();if(""===n)eW(e,"");else{let t=parseInt(n,10);eW(e,isNaN(t)?"":t)}},[eW]),eR=(0,i.useCallback)((e,t)=>{let n=t;if("threadScoreAggregation"===e)n=t;else{let e=String(t).trim();if(""===e)n="";else{let t=parseFloat(e);n=isNaN(t)?"":t}}eN("commentScoring",t=>({...t,[e]:n}))},[eN]),ez=(0,i.useCallback)((e,t)=>{let n=String(t).trim(),o=""===n||isNaN(parseFloat(n))?"":parseFloat(n);eN("threadInterestModel",t=>({...t,[e]:o}))},[eN]),eL=(0,i.useCallback)(e=>{eI(null);let t=2-e,n=(2-e)*2.5,o=Object.values(ej.sourceWeights).reduce((e,t)=>e+(""===t?0:t),0)||0,i=Math.max(1,Math.min((.05+(2-e)/2)*.25*o,o));ew(e=>({...e,threadInterestModel:{...e.threadInterestModel,logImpactFactor:t},commentScoring:{...e.commentScoring,commentSubscribedAuthorMultiplier:n},sourceWeights:{...e.sourceWeights,subscriptions:Math.round(i)}}))},[ew,ej.sourceWeights]),eD=(0,i.useCallback)(()=>{let e=a.a$.resolverSettings,t=e.threadInterestModel,n=e.commentScoring,o={resolverSettings:{sourceWeights:j()(C()(a.oz),ej.sourceWeights,(e,t)=>D(t,0)),incognitoMode:ej.incognitoMode,commentScoring:j()(C()(n),ej.commentScoring,(e,t,n)=>"threadScoreAggregation"===n?t||e:D(t,e)),threadInterestModel:j()(C()(t),ej.threadInterestModel,(e,t)=>D(t,e)),subscriptionsFeedSettings:ei.resolverSettings.subscriptionsFeedSettings},displaySettings:{lineClampNumberOfLines:0,postInitialWords:0,postMaxWords:0,commentCollapsedInitialWords:0,commentExpandedInitialWords:0,commentMaxWords:0}};"simple"===eb?(o.displaySettings.lineClampNumberOfLines=0,o.displaySettings.commentCollapsedInitialWords=ed.commentMap[ey.commentCollapsedInitialLevel],o.displaySettings.commentExpandedInitialWords=ed.commentMap[ey.commentExpandedInitialLevel],o.displaySettings.commentMaxWords=ed.commentMap[ey.commentMaxLevel],o.displaySettings.postInitialWords=ed.postMap[ey.postInitialLevel],o.displaySettings.postMaxWords=ed.postMap[ey.postMaxLevel]):(o.displaySettings.lineClampNumberOfLines=D(ej.displaySetting.lineClampNumberOfLines,0),o.displaySettings.postInitialWords=D(ej.displaySetting.postInitialWords,a.a$.displaySettings.postInitialWords),o.displaySettings.postMaxWords=D(ej.displaySetting.postMaxWords,a.a$.displaySettings.postMaxWords),o.displaySettings.commentCollapsedInitialWords=D(ej.displaySetting.commentCollapsedInitialWords,a.a$.displaySettings.commentCollapsedInitialWords),o.displaySettings.commentExpandedInitialWords=D(ej.displaySetting.commentExpandedInitialWords,a.a$.displaySettings.commentExpandedInitialWords),o.displaySettings.commentMaxWords=D(ej.displaySetting.commentMaxWords,a.a$.displaySettings.commentMaxWords));let i=y.safeParse(o);if(!i.success){let e=i.error.format();eI(e),console.error("UltraFeed Settings Validation Errors:",e);return}eI(null),ea(i.data),em("Settings saved"),ep("ultraFeedSettingsUpdated",{oldSettings:ei,newSettings:i.data})},[ej,ey,ea,ep,ei,eb,em,ed]),eE=(0,i.useCallback)(()=>{el(),eI(null),ep("ultraFeedSettingsReset")},[el,ep]),eH={levels:ey,onChange:eM,originalSettings:ei,maps:ed,postBreakpointError:(null==eC||null==(r=eC.displaySettings)||null==(n=r.postInitialWords)||null==(t=n._errors)?void 0:t[0])||(null==eC||null==(g=eC.displaySettings)||null==(m=g.postMaxWords)||null==(u=m._errors)?void 0:u[0]),commentBreakpointError:(null==eC||null==(f=eC.displaySettings)||null==(x=f.commentCollapsedInitialWords)||null==(h=x._errors)?void 0:h[0])||(null==eC||null==(S=eC.displaySettings)||null==(v=S.commentExpandedInitialWords)||null==(b=v._errors)?void 0:b[0])||(null==eC||null==(k=eC.displaySettings)||null==(I=k.commentMaxWords)||null==(w=I._errors)?void 0:w[0])},eU={values:ej.displaySetting,errors:{lineClampNumberOfLines:null==eC||null==(F=eC.displaySettings)||null==(W=F.lineClampNumberOfLines)||null==(N=W._errors)?void 0:N[0],postInitialWords:null==eC||null==(E=eC.displaySettings)||null==(A=E.postInitialWords)||null==(M=A._errors)?void 0:M[0],postMaxWords:null==eC||null==(V=eC.displaySettings)||null==(_=V.postMaxWords)||null==(P=_._errors)?void 0:P[0],commentCollapsedInitialWords:null==eC||null==(q=eC.displaySettings)||null==(G=q.commentCollapsedInitialWords)||null==($=G._errors)?void 0:$[0],commentExpandedInitialWords:null==eC||null==(J=eC.displaySettings)||null==(Z=J.commentExpandedInitialWords)||null==(Y=Z._errors)?void 0:Y[0],commentMaxWords:null==eC||null==(X=eC.displaySettings)||null==(K=X.commentMaxWords)||null==(Q=K._errors)?void 0:Q[0]},onLineClampChange:eB,onWordCountChange:eA},eO={formValues:{incognitoMode:ej.incognitoMode},onBooleanChange:eT},eP={currentLogImpactFactor:ej.threadInterestModel.logImpactFactor,onExploreBiasChange:eL},e_=(0,i.useMemo)(()=>null!==eC,[eC]);return(0,o.jsxs)("div",{className:eu.root,children:[(0,o.jsxs)("div",{className:eu.viewModeToggle,children:[(0,o.jsx)("div",{className:eu.spacer}),(0,o.jsxs)("div",{className:eu.viewModeButtonsContainer,children:[(0,o.jsx)(O,{mode:"simple",currentViewMode:eb,onClick:ev}),(0,o.jsx)(O,{mode:"advanced",currentViewMode:eb,onClick:ev})]}),(0,o.jsxs)("div",{className:eu.feedbackButtonContainer,children:[(0,o.jsx)("span",{className:s()(eu.feedbackButton,eg&&eu.feedbackButtonActive),onClick:()=>eh(!eg),children:"give feedback"}),ec&&(0,o.jsx)(B.A,{currentFeedType:"new"})]})]}),eg&&(0,o.jsx)(T,{}),(0,o.jsx)("div",{className:eu.settingsGroupsContainer,children:"simple"===eb?(0,o.jsx)(z,{exploreExploitBiasProps:eP,sourceWeights:ej.sourceWeights,sourceWeightErrors:ek,onSourceWeightChange:eF,truncationGridProps:eH,miscSettingsProps:eO}):(0,o.jsx)(L,{sourceWeights:ej.sourceWeights,sourceWeightErrors:ek,onSourceWeightChange:eF,advancedTruncationProps:eU,commentScoringFormValues:ej.commentScoring,commentScoringErrors:null!=(en=null==eC||null==(ee=eC.resolverSettings)?void 0:ee.commentScoring)?en:null,onCommentScoringFieldChange:eR,threadInterestModelFormValues:ej.threadInterestModel,threadInterestModelErrors:null!=(eo=null==eC||null==(et=eC.resolverSettings)?void 0:et.threadInterestModel)?eo:null,onThreadInterestFieldChange:ez,miscSettingsProps:eO})}),(0,o.jsxs)("div",{className:eu.buttonRow,children:[(0,o.jsx)("button",{className:s()(eu.button,eu.resetButton),onClick:eE,children:"Reset"}),(0,o.jsx)("button",{className:s()(eu.button,eu.saveButton,{[eu.buttonDisabled]:e_}),onClick:eD,disabled:e_,children:"Save"})]})]})}},68908:(e,t,n)=>{n.d(t,{A:()=>X});var o=n(95155),i=n(12115),a=n(36944),l=n(66121),r=n(82325),s=n(86055),d=n(84999),c=n(47207),p=n.n(c),u=n(69004),m=n(88262),g=n(213),h=n(84567),x=n(93344),f=n(93351),b=n(8302),v=n(83223),y=n(22299),S=n.n(y),j=n(94258),w=n(27360),C=n(65180),I=n(97885);let k=(0,I.J)("\n  query multiSubscriptionFollowUserSearchQuery($selector: SubscriptionSelector, $limit: Int, $enableTotal: Boolean) {\n    subscriptions(selector: $selector, limit: $limit, enableTotal: $enableTotal) {\n      results {\n        ...SubscriptionState\n      }\n      totalCount\n    }\n  }\n"),N=e=>{var t;let{hit:n,clickAction:i,existingSubscriptionIds:a,classes:l}=e,r=null==a?void 0:a.includes(n._id);return(0,o.jsxs)("div",{onClick:e=>!r&&(0,v.M)(e)&&i&&i(),className:S()(l.followUserSearchHit,{[l.followUserSearchHitAlreadySubscribed]:r}),children:[(0,o.jsx)(j.A,{className:l.followUserSearchHitDisplayName,children:n.displayName}),r?(0,o.jsx)(j.A,{children:"(already subscribed)"}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(j.A,{children:(0,o.jsx)(w.A,{date:n.createdAt})}),(0,o.jsxs)(j.A,{children:[null!=(t=n.karma)?t:0," karma"]})]})]})},W=(0,m.N)("FollowUserSearch",e=>{var t,n;let{onUserSelected:a,currentUser:l,classes:r}=e,[s,d]=i.useState(!1),c=i.useCallback(e=>{var t,n;d((null!=(n=null==(t=e.query)?void 0:t.length)?n:0)>0)},[]),{data:p}=(0,C.IT)(k,{variables:{selector:{subscriptionsOfType:{userId:null==l?void 0:l._id,collectionName:"Users",subscriptionType:"newActivityForFeed"}},limit:1e3,enableTotal:!1},notifyOnNetworkStatusChange:!0}),u=null==p||null==(t=p.subscriptions)?void 0:t.results,m=null!=(n=null==u?void 0:u.map(e=>e.documentId).filter(e=>null!==e))?n:[],v=i.useRef(null);return(i.useEffect(()=>{if(v.current){let e=v.current.getElementsByTagName("input")[0];setTimeout(()=>{e.focus()},0)}},[]),(0,b.Kt)())?(0,o.jsx)("div",{className:r.root,ref:v,children:(0,o.jsxs)(g.GT,{indexName:(0,b.sl)("Users"),searchClient:(0,b.cb)(),onSearchStateChange:c,children:[(0,o.jsx)(h.A,{reset:null,focusShortcuts:[]}),(0,o.jsx)(x.A,{hitsPerPage:s?12:6}),(0,o.jsx)(f.A,{hitComponent:e=>{let{hit:t}=e;return(0,o.jsx)(N,{hit:t,clickAction:()=>(e=>{e._id&&e.displayName&&a(e)})(t),existingSubscriptionIds:m,classes:r})}})]})}):null},{styles:e=>({root:{"& .ais-SearchBox":{padding:8},"& .ais-SearchBox-input":{background:"transparent"},"& .ais-SearchBox-submit":{position:"absolute",right:11},"& .ais-SearchBox-submitIcon path":{display:"none"},width:240},followUserSearchHit:{padding:10,paddingTop:2,paddingBottom:2,display:"flex",alignItems:"center"},followUserSearchHitAlreadySubscribed:{fontStyle:"italic"},followUserSearchHitDisplayName:{maxWidth:200,overflow:"hidden","@media (max-width: 500px)":{maxWidth:100}}})});var F=n(55348),M=n(72561),T=n(96973),B=n(40329),A=n(70097),R=n(67916),z=n(30128),L=n(53768),D=n(79850),E=n(34143),H=n(46107),U=n(41682);let O=(0,I.J)("\n  query UserRecentPostsForCompactCard($selector: PostSelector, $limit: Int, $enableTotal: Boolean) {\n    posts(selector: $selector, limit: $limit, enableTotal: $enableTotal) {\n      results {\n        ...PostsList\n      }\n    }\n  }\n"),P=(0,B.Il)("UltraFeedSuggestedUserCard",e=>({root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",height:152,fontSize:14,fontWeight:450,lineHeight:"19.5px",color:e.palette.text.primary,backgroundColor:e.palette.panelBackground.default,border:"1px solid ".concat(e.palette.grey[300]),borderRadius:8,padding:16,minHeight:140,overflow:"hidden",transition:"box-shadow 0.2s ease",cursor:"pointer",...e.typography.postStyle,"&:hover":{boxShadow:e.palette.boxShadow.default}},nameRow:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8,gap:8},name:{fontSize:"1.8rem",fontWeight:400,lineHeight:"1.2",color:e.palette.grey.A400,flex:"1 1 auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},nameLink:{color:"inherit",textDecoration:"none",cursor:"pointer","&:hover":{opacity:.7}},followButtonWrapper:{flexShrink:0},metaRow:{fontSize:"0.9rem",marginBottom:8,color:e.palette.grey[600],"& .UserMetaInfo-info":{marginRight:12}},bio:{marginBottom:8,lineHeight:"1.2rem",fontSize:"0.9rem"},bioText:{...(0,H.oP)(e),marginTop:0,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis","& p":{margin:0},"& p:first-child":{marginTop:0}},recentPosts:{borderTop:"1px solid ".concat(e.palette.grey[300]),paddingTop:4,display:"flex",flexDirection:"column",flex:1,minHeight:0,overflow:"hidden",width:"100%"},postWrapper:{position:"relative",width:"100%",height:"auto",overflow:"hidden",display:"table",tableLayout:"fixed"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",flex:1}})),_=e=>{var t;let{user:n,onFollowToggle:s}=e,d=(0,B.IS)(P),{openDialog:c}=(0,A.sp)(),p=(0,i.useRef)(null),u=(0,r.TA)(),m=!!(n.htmlBio&&n.htmlBio.trim().length>0),{data:g,loading:h}=(0,C.IT)(O,{variables:{selector:{userPosts:{userId:n._id,sortedBy:"new"}},limit:2,enableTotal:!1},skip:m,notifyOnNetworkStatusChange:!0}),x=(0,i.useCallback)(()=>{c({name:"UltraFeedUserDialog",closeOnNavigate:!0,contents:e=>{let{onClose:t}=e;return(0,o.jsx)(E.A,{user:n,onClose:t})}})},[c,n]),f=(0,i.useCallback)(e=>{var t;(null==(t=p.current)||!t.contains(e.target))&&(e.target.closest("a")||x())},[x]),b=(0,i.useCallback)(e=>{e.stopPropagation(),u&&(null==s||s(n))},[u,n,s]);if(!(null==n?void 0:n._id))return(0,o.jsx)("div",{className:d.root,children:"User not found"});let{htmlBio:v,displayName:y}=n,j=(0,L.sh)(n),w=null==g||null==(t=g.posts)?void 0:t.results;return(0,o.jsx)(a.Ig,{pageElementContext:"suggestedUserCard",userIdDisplayed:n._id,children:(0,o.jsxs)("div",{className:d.root,onClick:f,children:[(0,o.jsxs)("div",{className:d.nameRow,children:[(0,o.jsx)(l.Link,{to:j,className:S()(d.name,d.nameLink),onClick:e=>{e.preventDefault(),e.stopPropagation(),x()},children:y}),(0,o.jsx)("div",{ref:p,className:d.followButtonWrapper,onClick:b,children:(0,o.jsx)(R.A,{user:n,styleVariant:"ultraFeed"})})]}),(0,o.jsx)("div",{className:d.metaRow,children:(0,o.jsx)(z.A,{user:n})}),m&&(0,o.jsx)(D.A,{className:d.bio,contentType:"postHighlight",children:(0,o.jsx)("div",{className:d.bioText,dangerouslySetInnerHTML:{__html:v}})}),!m&&h&&(0,o.jsx)("div",{className:d.loadingContainer,children:(0,o.jsx)(T.default,{})}),!m&&w&&w.length>0&&(0,o.jsx)("div",{className:d.recentPosts,children:w.slice(0,2).map(e=>e&&(0,o.jsx)("div",{className:d.postWrapper,children:(0,o.jsx)(U.A,{post:e,hideAuthor:!0,disableHoverPreview:!0})},e._id))})]})})};var V=n(62677),$=n(95178),G=n(32835),q=n(21001),Y=n.n(q),Z=n(63591);let J=(0,I.J)("\n  query UserFollowingCount($selector: SubscriptionSelector, $limit: Int, $enableTotal: Boolean) {\n    subscriptions(selector: $selector, limit: $limit, enableTotal: $enableTotal) {\n      totalCount\n    }\n  }\n"),Q=(0,B.Il)("SuggestedFeedSubscriptions",e=>({root:{display:"flex",flexDirection:"column",width:"100%",paddingTop:16,paddingBottom:16,marginBottom:6},titleRow:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"flex-start",marginBottom:5},titleAndManageLink:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1},sectionTitle:{...e.typography.postStyle,display:"block",fontSize:"1.8rem",flexGrow:1},manageSubscriptionsLink:{padding:8,...e.typography.commentStyle,fontSize:"1rem",opacity:.7,"&:hover":{opacity:.5}},userSubscribeCards:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:4,[e.breakpoints.down("xs")]:{gridTemplateColumns:"1fr",gap:8,justifyItems:"center"}},icon:{width:20,color:e.palette.grey[600],marginBottom:-3,cursor:"pointer","&:hover":{color:e.palette.grey[500]}},followUserSearchButton:{...e.typography.commentStyle,color:e.palette.grey[600],display:"inline-block",textAlign:"center","@media print":{display:"none"}},followUserSearchIcon:{width:18,marginBottom:-4,marginRight:4},hideOnSmallScreens:{"@media(max-width: 500px)":{display:"none"}},bottomButtonsContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},manageButton:{...e.typography.body2,...e.typography.commentStyle,color:e.palette.lwTertiary.main,display:"inline-block",minHeight:20},followingCount:{fontWeight:600},refreshButton:{...e.typography.body2,...e.typography.commentStyle,color:e.palette.lwTertiary.main,display:"inline-block",minHeight:20}})),K=e=>{let{onUserSelected:t,tooltipPlacement:n="bottom-end"}=e,l=(0,B.IS)(Q),[d,c]=(0,i.useState)(!1),p=(0,i.useRef)(null),m=(0,r.iZ)(),{captureEvent:g}=(0,a.z1)();return m?(0,o.jsxs)("a",{onClick:()=>{c(!0),g("followUserSearchClicked")},className:l.followUserSearchButton,ref:p,children:[(0,o.jsx)("span",{className:l.followUserSearchButton,children:(0,o.jsx)(M.A,{icon:"Search",className:l.followUserSearchIcon})}),(0,o.jsx)(u.default,{open:d,anchorEl:p.current,placement:n,allowOverflow:!0,children:(0,o.jsx)(F.A,{onClickAway:()=>c(!1),children:(0,o.jsx)(s.t,{children:(0,o.jsx)(W,{currentUser:m,onUserSelected:e=>{c(!1),t(e)}})})})})]}):null},X=e=>{var t,n;let{suggestedUsers:s,settingsButton:c,enableDismissButton:u=!0}=e,m=(0,B.IS)(Q),g=(0,V.al)(),h=(0,r.iZ)(),[x,f]=(0,$.j)([G.Y5]),{availableUsers:b,loadingSuggestedUsers:v}=function(){var e,t,n;let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=(0,r.iZ)(),[l,s]=(0,i.useState)([]),{data:c,loading:u}=(0,C.IT)((0,I.J)("\n    query SuggestedFeedSubscriptionUsers($limit: Int) {\n      SuggestedFeedSubscriptionUsers(limit: $limit) {\n        results {\n          ...UsersMinimumInfo\n        }\n      }\n    }\n  "),{variables:{limit:64},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",ssr:!1,skip:o||!a||!(0,d.zj)(a)}),{data:m,loading:g}=(0,C.IT)((0,I.J)("\n    query SuggestedTopActiveUsers($limit: Int) {\n      SuggestedTopActiveUsers(limit: $limit) {\n        results {\n          ...UsersMinimumInfo\n        }\n      }\n    }\n  "),{variables:{limit:64},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",ssr:!1,skip:o||!!a}),h=null!=(n=null==c||null==(e=c.SuggestedFeedSubscriptionUsers)?void 0:e.results)?n:null==m||null==(t=m.SuggestedTopActiveUsers)?void 0:t.results;return(0,i.useEffect)(()=>{s(p()(null!=h?h:[]))},[h]),{availableUsers:l,setAvailableUsers:s,loadingSuggestedUsers:u||g}}(!!s),[y,S]=(0,i.useState)([]);(0,i.useEffect)(()=>{s?S(p()(s)):b&&S(b)},[s,b]);let[j,w]=(0,i.useState)(new Set),[k,N]=(0,i.useState)([]),{data:W}=(0,C.IT)(J,{variables:{selector:{subscriptionsOfType:{userId:null==h?void 0:h._id,collectionName:"Users",subscriptionType:"newActivityForFeed"}},limit:1,enableTotal:!0},skip:!h,ssr:!1}),F=null!=(n=null==W||null==(t=W.subscriptions)?void 0:t.totalCount)?n:0,A=g?2:4,R=F<2?2*A:A,{captureEvent:z}=(0,a.z1)();if((0,i.useEffect)(()=>{if(y.length>0&&0===k.length){let e=y.slice(0,R);N(e),w(new Set(e.map(e=>e._id)))}},[y,k.length,R]),x[G.Y5]&&u)return null;let L=e=>{S(y.filter(t=>t._id!==e._id))},D=v&&!y.length&&!s;return(0,o.jsx)(a.Ig,{pageFeedElementContext:"suggestedFeedSubscriptions",children:(0,o.jsxs)("div",{className:m.root,children:[(0,o.jsx)("div",{className:m.titleRow,children:(0,o.jsxs)("div",{className:m.titleAndManageLink,children:[(0,o.jsx)("div",{className:m.sectionTitle,children:h?"Suggested Users for You":"Suggested Users"}),(0,o.jsx)(K,{onUserSelected:L}),u&&(0,o.jsx)(Z.default,{title:"Hide suggested users for 60 days",children:(0,o.jsx)("div",{onClick:e=>{e.preventDefault(),f(G.Y5,"true",{expires:Y()().add(60,"days").toDate()})},children:(0,o.jsx)(M.A,{icon:"Close",className:m.icon})})}),c]})}),D&&(0,o.jsx)(T.default,{}),!D&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:m.userSubscribeCards,children:k.map(e=>(0,o.jsx)(_,{user:e,onFollowToggle:()=>L(e)},e._id))}),(0,o.jsxs)("div",{className:m.bottomButtonsContainer,children:[(0,o.jsxs)(l.Link,{to:"/manageSubscriptions",className:m.manageButton,children:[(0,o.jsx)("span",{className:m.followingCount,children:F})," following"]}),y.length>R&&(0,o.jsx)("a",{className:m.refreshButton,onClick:e=>{e.preventDefault();let t=y.filter(e=>!j.has(e._id));if(t.length>=R){let e=t.slice(0,R);N(e),w(t=>new Set([...t,...e.map(e=>e._id)]))}else{let e=p()([...y]).slice(0,R);N(e),w(new Set(e.map(e=>e._id)))}z("refreshedUltraFeedSuggestedUsers")},children:"Refresh"})]})]})]})})}},82645:(e,t,n)=>{n.d(t,{e:()=>o});function o(e){return e?Math.max(0,e.getBoundingClientRect().top+window.pageYOffset-96):0}},85343:(e,t,n)=>{n.d(t,{P:()=>L});var o=n(95155),i=n(12115),a=n(37318),l=n(48405),r=n(22085),s=n(22299),d=n.n(s),c=n(66121),p=n(93664),u=n(30761),m=n(40329),g=n(70391),h=n(33060),x=n(36944),f=n(323),b=n(95078),v=n(70097),y=n(16747),S=n(50207),j=n(72561),w=n(63591),C=n(78030),I=n(69630),k=n(39999),N=n(53528);let W=e=>({mask:"linear-gradient(to right, ".concat(e.join(","),")")}),F=(0,m.Il)("UltraFeedSpotlightItem",e=>({root:{background:e.palette.panelBackground.bannerAdTranslucentHeavy,maxWidth:p.l,marginLeft:"auto",marginRight:"auto",width:p.l,marginBottom:12,boxShadow:e.palette.boxShadow.default,borderRadius:e.borderRadius.default,"&:hover":{boxShadow:e.palette.boxShadow.sequencesGridItemHover},[e.breakpoints.down("sm")]:{width:"auto",marginBottom:0,boxShadow:"none",borderRadius:0,paddingTop:12,paddingBottom:16,paddingLeft:16,paddingRight:16,overflow:"visible","&:hover":{boxShadow:"none"}}},rootWithFooter:{[e.breakpoints.down("sm")]:{paddingBottom:0}},spotlightItem:{position:"relative",borderRadius:e.borderRadius.default,overflow:"hidden",[e.breakpoints.down("sm")]:{overflow:"visible",borderRadius:0}},contentContainer:{display:"flex",flexDirection:"column",position:"relative",overflow:"hidden",background:e.palette.panelBackground.default,[e.breakpoints.down("sm")]:{overflow:"visible",background:"transparent"}},spotlightFadeBackground:{background:"var(--spotlight-fade)"},content:{display:"flex",flexDirection:"column",width:"100%",position:"relative",zIndex:1,paddingTop:12,paddingLeft:16,paddingRight:16,minHeight:100,[e.breakpoints.down("sm")]:{padding:0,minHeight:"auto",display:"flex",flexDirection:"column"}},contentWithPaddingBottom:{paddingBottom:12,[e.breakpoints.down("sm")]:{paddingBottom:16}},header:{display:"flex",flexDirection:"column",gap:"2px",maxWidth:"calc(100% - ".concat(150,"px)"),marginBottom:4,position:"relative",zIndex:1,[e.breakpoints.down("sm")]:{maxWidth:"100%",gap:"4px",position:"relative",order:1,marginBottom:12}},titleContainer:{display:"flex",alignItems:"baseline"},title:{fontFamily:e.palette.fonts.sansSerifStack,fontWeight:600,opacity:.8,lineHeight:1.15,textWrap:"balance",cursor:"pointer","&:hover":{opacity:.9,textDecoration:"none"},fontSize:"1.3rem",whiteSpace:"normal",[e.breakpoints.down("sm")]:{}},metaRow:{display:"flex",color:e.palette.text.dim,fontFamily:e.palette.fonts.sansSerifStack,fontSize:e.typography.body2.fontSize,alignItems:"baseline",columnGap:"16px",rowGap:"4px",marginBottom:"12px",position:"relative",zIndex:1,[e.breakpoints.down("sm")]:{columnGap:"8px",rowGap:"0px",flexWrap:"wrap","& > a, & > span":{whiteSpace:"nowrap"},order:3,marginTop:24,marginBottom:0}},subtitleGroup:{display:"flex",alignItems:"baseline",gap:"8px",flexWrap:"nowrap"},subtitle:{...e.typography.postStyle,...e.typography.italic,color:"inherit",fontSize:"inherit",fontFamily:"inherit"},curatedIcon:{"--icon-size":"16px",fontSize:"16px",color:e.palette.ultraFeed.dim,opacity:.8,position:"relative",top:2},imageContainer:{position:"absolute",zIndex:0,alignSelf:"stretch",display:"flex",justifyContent:"flex-end",top:0,right:0,width:"100%",height:"100%",margin:0,[e.breakpoints.down("sm")]:{position:"relative",width:"auto",height:"auto",top:"auto",right:"auto",margin:"-12px -16px -20px -16px",order:2}},imageContainerWithAuthor:{[e.breakpoints.down("sm")]:{marginTop:-12}},image:{objectFit:"cover",height:"100%",position:"absolute",top:0,right:0,borderTopRightRadius:e.borderRadius.default,borderBottomRightRadius:e.borderRadius.default,[e.breakpoints.down("sm")]:{position:"relative",width:"100%",height:"auto",top:"auto",right:"auto",maxWidth:"100%",objectPosition:"center center",maxHeight:200,minHeight:150,borderRadius:0}},imageVerticalFade:{[e.breakpoints.down("sm")]:{...((e,t)=>{var n;return n=t.map(t=>{let[n,o]=t;return"".concat(e.palette.inverseGreyAlpha(n)," ").concat(100*o,"%")}),{mask:"linear-gradient(to bottom, ".concat(n.join(","),")")}})(e,[[0,0],[.1,.05],[.5,.1],[.9,.15],[1,.2],[1,.8],[.9,.85],[.5,.9],[.1,.95],[0,1]])}},imageFade:{[e.breakpoints.up("md")]:{...W(["transparent 0","".concat(e.palette.text.alwaysWhite," 80%"),"".concat(e.palette.text.alwaysWhite," 100%")])}},imageFadeCustom:{[e.breakpoints.up("md")]:{...W(["transparent 0","transparent 30%","".concat(e.palette.text.alwaysWhite," 90%"),"".concat(e.palette.text.alwaysWhite," 100%")])}},descriptionArea:{zIndex:1,display:"flex",flexDirection:"column",gap:"8px",maxWidth:"calc(100% - ".concat(150,"px)"),[e.breakpoints.down("sm")]:{maxWidth:"100%",position:"relative",marginTop:12,order:4}},descriptionWrapper:{cursor:"pointer"},description:{...(0,g.Zf)(e),opacity:.9,position:"relative",[e.breakpoints.down("sm")]:{fontSize:"1.3rem",position:"static"}},splashImage:{filter:"brightness(1.2)",transform:"translateX(13%) scale(1.15)",[e.breakpoints.down("sm")]:{transform:"none"}},footer:{marginTop:8,marginBottom:12,position:"relative",zIndex:1,"& .UltraFeedItemFooter-bookmarkButton":{filter:"\n            drop-shadow(0px 0px 2px ".concat(e.palette.background.default,")\n            drop-shadow(0px 0px 4px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 8px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 12px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 20px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 30px ").concat(e.palette.background.default,")\n          "),opacity:1,color:"".concat(e.palette.grey[600]," !important")},"& .SeeLessButton-root svg":{filter:"\n            drop-shadow(0px 0px 4px ".concat(e.palette.background.default,")\n            drop-shadow(0px 0px 8px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 16px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 24px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 40px ").concat(e.palette.background.default,")\n            drop-shadow(0px 0px 60px ").concat(e.palette.background.default,")\n          "),opacity:1,color:"".concat(e.palette.grey[1e3]," !important")},[e.breakpoints.down("sm")]:{marginTop:12,marginBottom:0,marginLeft:-16,marginRight:-16,paddingLeft:16,paddingRight:16,paddingBottom:12,order:5,"& .UltraFeedItemFooter-bookmarkButton":{filter:"none"},"& .SeeLessButton-root svg":{filter:"none",color:"".concat(e.palette.ultraFeed.dim," !important"),opacity:.7}}}}),{stylePriority:-1}),M=e=>{let{isPost:t,url:n,handleContentClick:i,children:a}=e,l=(0,m.IS)(F);return t?(0,o.jsx)("div",{className:l.descriptionWrapper,onClick:i,children:a}):(0,o.jsx)(c.Link,{to:n,className:l.descriptionWrapper,children:a})},T=e=>{let{spotlight:t,isPost:n,url:i,handleContentClick:a,className:l}=e,r=(0,m.IS)(F);return(0,o.jsx)("div",{className:l,children:(0,o.jsx)("div",{className:r.titleContainer,children:n?(0,o.jsx)("a",{href:i,onClick:a,className:r.title,children:(0,g.NG)(t)}):(0,o.jsx)(c.Link,{to:i,className:r.title,children:(0,g.NG)(t)})})})},B=e=>{var t,n;let{spotlight:i,spotlightDocument:a,post:l,showSubtitle:r,className:s}=e,d=(0,m.IS)(F),p=i.subtitleUrl?(0,o.jsx)(c.Link,{to:i.subtitleUrl,children:i.customSubtitle}):i.customSubtitle;return i.showAuthor||i.customSubtitle||(null==l||null==(t=l.contents)?void 0:t.wordCount)?(0,o.jsxs)("div",{className:s,children:[i.showAuthor&&(null==a?void 0:a.user)&&(0,o.jsx)(N.A,{user:a.user}),(null==l||null==(n=l.contents)?void 0:n.wordCount)&&(0,o.jsxs)("span",{children:[l.contents.wordCount," words"]}),i.customSubtitle&&r&&(0,o.jsxs)("span",{className:d.subtitleGroup,children:[(0,o.jsx)("span",{className:d.subtitle,children:p}),(0,o.jsx)(w.default,{title:"This is a featured item",children:(0,o.jsx)(j.A,{icon:"Star",className:d.curatedIcon})})]})]}):null},A=e=>{let{spotlight:t,spotlightDocument:n,className:i}=e,a=(0,m.IS)(F);return t.spotlightSplashImageUrl||t.spotlightImageId?(0,o.jsxs)("div",{className:d()(i,{[a.imageContainerWithAuthor]:t.showAuthor&&(null==n?void 0:n.user)}),children:[t.spotlightSplashImageUrl&&(0,o.jsx)("img",{src:t.spotlightSplashImageUrl,className:d()(a.image,a.imageVerticalFade,a.imageFade,a.splashImage)}),t.spotlightImageId&&(0,o.jsx)(b.A,{publicId:t.spotlightImageId,darkPublicId:t.spotlightDarkImageId,className:d()(a.image,a.imageVerticalFade,{[a.imageFade]:t.imageFade&&!t.imageFadeColor,[a.imageFadeCustom]:t.imageFade&&t.imageFadeColor}),imgProps:{w:"800"},loading:"lazy"})]}):null},R=e=>{var t,n,a,l;let{spotlight:r,post:s,index:c,showSubtitle:p=!0,className:g,spotlightMetaInfo:b}=e,j=(0,m.IS)(F),{observe:w}=(0,h.eo)(),{openDialog:N}=(0,v.sp)(),W=(0,i.useRef)(null),[R,z]=(0,i.useState)(!1),L=(0,k.Av)(),D=(0,i.useMemo)(()=>({displayStatus:"expanded",sources:["spotlights"],highlight:!0,lastServed:L,lastViewed:null,lastInteracted:null}),[L]),E=(0,i.useCallback)(e=>{(0,I.Pl)(e)&&s&&(e.preventDefault(),N({name:"UltraFeedPostDialog",closeOnNavigate:!0,contents:e=>{let{onClose:t}=e;return(0,o.jsx)(y.A,{partialPost:s,postMetaInfo:D,onClose:t})}}))},[N,s,D]);if((0,i.useEffect)(()=>{let e=W.current;if(e&&r){var t;w(e,{documentId:r._id,documentType:"spotlight",feedCardIndex:c,servedEventId:null!=(t=null==b?void 0:b.servedEventId)?t:""})}},[w,r,c,null==b?void 0:b.servedEventId]),!r)return null;let H=(0,u.q)(r),U=null!=(a=null!=(n=r.post)?n:r.sequence)?a:r.tag,O="Post"===r.documentType&&!!s,P={"--spotlight-fade":r.imageFadeColor};return(0,o.jsx)(x.Ig,{ultraFeedElementType:"feedSpotlight",spotlightId:r._id,feedCardIndex:c,children:(0,o.jsx)("div",{ref:W,id:r._id,style:P,className:d()(j.root,g,{[j.rootWithFooter]:O}),children:(0,o.jsx)("div",{className:d()(j.spotlightItem,{[j.spotlightFadeBackground]:!!r.imageFadeColor}),children:(0,o.jsx)("div",{className:j.contentContainer,children:(0,o.jsxs)("div",{className:d()(j.content,{[j.contentWithPaddingBottom]:!O}),children:[(0,o.jsx)(T,{spotlight:r,isPost:O,url:H,handleContentClick:E,className:j.header}),(0,o.jsx)(A,{spotlight:r,spotlightDocument:U,className:j.imageContainer}),(0,o.jsx)(B,{spotlight:r,spotlightDocument:U,post:s,showSubtitle:p,className:j.metaRow}),(0,o.jsx)("div",{className:j.descriptionArea,children:(0,o.jsx)(M,{isPost:O,url:H,handleContentClick:E,children:(0,o.jsx)(f.A,{html:null!=(l=null==(t=r.description)?void 0:t.html)?l:"",initialWordCount:C.yO,maxWordCount:C.yO,hideSuffix:!0,className:j.description})})}),O&&s&&(0,o.jsx)("div",{className:j.footer,children:(0,o.jsx)(S.A,{document:s,collectionName:"Posts",metaInfo:D,replyConfig:{isReplying:R,onReplyClick:()=>z(!R),onReplySubmit:()=>z(!1),onReplyCancel:()=>z(!1)},hideReacts:!0})})]})})})})})};var z=n(68908);function L(e){let{settings:t}=e;return{feedCommentThread:{render:(e,n)=>{if(!e)return null;let i={...e,postSources:e.postSources};return(0,o.jsx)(a.A,{children:(0,o.jsx)(l.A,{thread:i,settings:t,index:n})})}},feedPost:{render:(e,n)=>e?(0,o.jsx)(a.A,{children:(0,o.jsx)(r.A,{post:e.post,postMetaInfo:e.postMetaInfo,settings:t,index:n})}):null},feedSpotlight:{render:(e,t)=>{var n;if(!e||!e.spotlight)return null;let i=e.spotlightMetaInfo?{...e.spotlightMetaInfo,sources:e.spotlightMetaInfo.sources}:void 0;return(0,o.jsx)(a.A,{children:(0,o.jsx)(R,{spotlight:e.spotlight,post:null!=(n=e.post)?n:void 0,spotlightMetaInfo:i,showSubtitle:!0,index:t})})}},feedSubscriptionSuggestions:{render:(e,t)=>e&&e.suggestedUsers?(0,o.jsx)(a.A,{children:(0,o.jsx)(z.A,{suggestedUsers:e.suggestedUsers})}):null}}}},92328:(e,t,n)=>{n.d(t,{A:()=>x});var o=n(95155),i=n(12115),a=n(82325),l=n(93664),r=n(90252),s=n(60442),d=n(88337),c=n(40329),p=n(85343),u=n(49831),m=n(68908),g=n(82645);let h=(0,c.Il)("UltraFeedSubscriptionsFeed",e=>({feedContainer:{},ultraFeedFollowingHeader:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:16},checkboxContainer:{display:"flex",alignItems:"center",color:e.palette.grey[600]},checkboxInput:{padding:4,color:e.palette.grey[500]},checkboxLabel:{cursor:"pointer",fontSize:"1.15rem",fontFamily:e.typography.fontFamily,textWrap:"nowrap"},returnToTopBar:{display:"flex",justifyContent:"center",padding:"16px 0",marginTop:16},returnToTopLink:{...e.typography.commentStyle,color:e.palette.primary.main,fontSize:14,cursor:"pointer","&:hover":{opacity:.8}}})),x=e=>{var t,n,x;let{embedded:f=!1,refetchRef:b,settings:v,updateSettings:y,showHideReadToggle:S=!0}=e,j=(0,c.IS)(h),w=(0,a.iZ)(),[C,I]=(0,i.useState)(!0),k=(0,i.useRef)(null),[N,W]=(0,i.useState)(!1),F=(0,i.useCallback)((e,t)=>{I(t),!t&&N&&setTimeout(()=>{W(!1)},100)},[N]);if(!w)return(0,o.jsx)(l.A,{children:(0,o.jsx)(m.A,{enableDismissButton:!1})});let{feedCommentThread:M,feedPost:T,feedSubscriptionSuggestions:B}=(0,p.P)({settings:v}),A=null!=(x=null==v||null==(n=v.resolverSettings)||null==(t=n.subscriptionsFeedSettings)?void 0:t.hideRead)&&x,R=(0,o.jsxs)("div",{ref:k,className:j.feedContainer,style:N?{minHeight:1500}:void 0,children:[S&&(0,o.jsx)("div",{className:j.ultraFeedFollowingHeader,children:(0,o.jsxs)("div",{className:j.checkboxContainer,children:[(0,o.jsx)(u.A,{className:j.checkboxInput,checked:A,onChange:e=>{var t;return t=e.target.checked,void(y&&(W(!0),y({resolverSettings:{...v.resolverSettings,subscriptionsFeedSettings:{...v.resolverSettings.subscriptionsFeedSettings,hideRead:t}}})))}}),(0,o.jsx)("span",{className:j.checkboxLabel,children:" Hide Read "})]})}),(0,o.jsx)(s.A,{query:d.B9,variables:{settings:{subscriptionsFeedSettings:{hideRead:A}}},firstPageSize:20,pageSize:30,fetchPolicy:"network-only",refetchRef:b,onLoadingStateChange:F,renderers:{feedCommentThread:M,feedPost:T,feedSubscriptionSuggestions:B}}),!C&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(m.A,{enableDismissButton:!1}),(0,o.jsx)("div",{className:j.returnToTopBar,children:(0,o.jsx)("a",{className:j.returnToTopLink,onClick:()=>{let e=(0,g.e)(k.current);window.scrollTo({top:e,behavior:"smooth"})},children:"Return to top of feed"})})]})]});return f?R:(0,o.jsxs)(l.A,{children:[(0,o.jsx)(r.Ay,{title:"Following"}),R]})}}}]);
//# sourceMappingURL=1084-d951351dead915be.js.map